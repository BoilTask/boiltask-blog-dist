<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>UnrealEngine on BoilTask's Blog</title><link>https://boiltask.com/tags/unrealengine/</link><description>Recent content in UnrealEngine on BoilTask's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Tue, 04 Nov 2025 13:21:54 +0800</lastBuildDate><atom:link href="https://boiltask.com/tags/unrealengine/index.xml" rel="self" type="application/rss+xml"/><item><title>虚幻引擎中重定向的相关知识</title><link>https://boiltask.com/knowledge/ue/ue-redirect/</link><pubDate>Tue, 04 Nov 2025 13:21:54 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/ue-redirect/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>在虚幻引擎中，随着项目的发展有可能需要对资产或者逻辑进行重命名。&lt;/p>
&lt;p>为了避免修改之后老的资产不可用，虚幻引擎有一套较为完善的重定向系统。&lt;/p>
&lt;h2 id="资产重定向">&lt;a href="#%e8%b5%84%e4%ba%a7%e9%87%8d%e5%ae%9a%e5%90%91" class="header-anchor">&lt;/a>资产重定向
&lt;/h2>&lt;p>当连接版本控制之后，虚幻引擎在移动或者重命名资产时会在此资产的旧位置留下一个重定向器。&lt;/p>
&lt;p>这可以使得引用此资产的逻辑可以在新的位置找到它。&lt;/p>
&lt;h2 id="逻辑重定向">&lt;a href="#%e9%80%bb%e8%be%91%e9%87%8d%e5%ae%9a%e5%90%91" class="header-anchor">&lt;/a>逻辑重定向
&lt;/h2>&lt;p>在修改变量名、函数名的时候，我们希望蓝图不会因为此次修改立刻报错。&lt;/p>
&lt;p>此时可以添加一个&lt;code>Core Redirects&lt;/code>配置。&lt;/p>
&lt;blockquote>
&lt;p>推荐使用&lt;a class="link" href="https://www.jetbrains.com/rider/" target="_blank" rel="noopener"
>Rider&lt;/a>，最新版本可以在重构时自动生成此配置。&lt;/p>&lt;/blockquote>
&lt;h2 id="参考文章">&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0" class="header-anchor">&lt;/a>参考文章
&lt;/h2>&lt;ul>
&lt;li>&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/core-redirects-in-unreal-engine" target="_blank" rel="noopener"
>虚幻引擎中的资产重定向器&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/core-redirects-in-unreal-engine" target="_blank" rel="noopener"
>虚幻引擎中的Core Redirects&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://dev.epicgames.com/community/learning/tutorials/qpZ3/unreal-engine-ca0ed0#%E9%87%8D%E5%AE%9A%E5%90%91%E5%99%A8%E6%8E%A2%E7%A9%B6" target="_blank" rel="noopener"
>关于虚幻引擎“最佳做法”的真相&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>虚幻引擎中各种类型的废弃（Deprecate）标记语法</title><link>https://boiltask.com/knowledge/ue/ue-deprecate/</link><pubDate>Tue, 04 Nov 2025 13:20:22 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/ue-deprecate/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>随着项目的发展，可能会发现需要重构一些逻辑。对于C++相对还是比较容易的，目前主流的IDE都提供了一定的重构能力，可以比较方便地进行重命名、查找引用等操作。&lt;/p>
&lt;p>然后对于蓝图来说，可能就不太好直接一键操作了，直接改变老的逻辑有可能产生很多问题。尤其是对于已经有了大量引用地逻辑，如果直接改动可能产生预期之外的工作量。这个时候一个选择是做一个新版的实现，然后逐步废弃老的实现。为了优雅地实现这一目的，虚幻引擎提供了一些用于标记废弃的语法。&lt;/p>
&lt;blockquote>
&lt;p>如果项目中应用了额外的脚本语言，需要参考对应实现来选择一个重构方式。&lt;/p>
&lt;p>推荐使用Puerts作为一个类型安全的脚本语言，也许可以参考这篇文章：&lt;a class="link" href="https://boiltask.com/knowledge/ue/unlua-to-puerts/" >虚幻引擎适用于Unlua转到PuerTS的一些知识&lt;/a>&lt;/p>&lt;/blockquote>
&lt;h2 id="重定向">&lt;a href="#%e9%87%8d%e5%ae%9a%e5%90%91" class="header-anchor">&lt;/a>重定向
&lt;/h2>&lt;p>如果是需要重命名，可以优先考虑使用UE的重定向系统：&lt;a class="link" href="https://boiltask.com/knowledge/ue/ue-redirect/" >虚幻引擎中重定向的相关知识&lt;/a>。&lt;/p>
&lt;h2 id="废弃标记">&lt;a href="#%e5%ba%9f%e5%bc%83%e6%a0%87%e8%ae%b0" class="header-anchor">&lt;/a>废弃标记
&lt;/h2>&lt;h3 id="uproperty">&lt;a href="#uproperty" class="header-anchor">&lt;/a>UP­ROP­ER­TY
&lt;/h3>&lt;p>对于一个属性来说，只需要将变量重命名为&lt;code>_DEPRECATED&lt;/code>版本，并且附加上废弃标识即可。&lt;/p>
&lt;p>这不会影响到原有蓝图的编译，可以在此期间删除引用。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">UPROPERTY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">EditAnywhere&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">int32&lt;/span> &lt;span class="n">Value&lt;/span>&lt;span class="p">;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">UPROPERTY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">meta&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">DeprecatedProperty&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">DeprecationMessage&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Use NewValue instead.&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">int32&lt;/span> &lt;span class="n">Value_DEPRECATED&lt;/span>&lt;span class="p">;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ufunction">&lt;a href="#ufunction" class="header-anchor">&lt;/a>UFUNC­TION
&lt;/h3>&lt;p>对于&lt;code>UFUNC­TION&lt;/code>比较简单，给函数添加上&lt;code>meta&lt;/code>属性&lt;code>DeprecatedFunction&lt;/code>即可。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">UPROPERTY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">BlueprintPure&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">GetValue&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">UPROPERTY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">BlueprintPure&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">meta&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">DeprecatedFunction&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">DeprecationMessage&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Use GetNewValue() instead.&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">GetValue&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="uclass">&lt;a href="#uclass" class="header-anchor">&lt;/a>UCLASS
&lt;/h3>&lt;p>对于&lt;code>UCLASS&lt;/code>来说，也需要进行重命名。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">UCLASS&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">UTestObject&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="k">public&lt;/span> &lt;span class="n">UObject&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GENERATED_BODY&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">UCLASS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Deprecated&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">UDEPRECATED_TestObject&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="k">public&lt;/span> &lt;span class="n">UObject&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">GENERATED_BODY&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="uenum--ustruct">&lt;a href="#uenum--ustruct" class="header-anchor">&lt;/a>UENUM &amp;amp; USTRUCT
&lt;/h3>&lt;p>似乎并不支持上述&lt;code>DEPRECATED_&lt;/code>的语法来影响蓝图编译，不过对于C++似乎引擎存在标记&lt;code>UE_DEPRECATED&lt;/code>的语法。&lt;/p>
&lt;p>更推荐改个已废弃的名，然后使用重定向系统来处理：&lt;a class="link" href="https://boiltask.com/knowledge/ue/ue-redirect/" >虚幻引擎中重定向的相关知识&lt;/a>。&lt;/p>
&lt;h3 id="ue_deprecated">&lt;a href="#ue_deprecated" class="header-anchor">&lt;/a>UE_DEPRECATED
&lt;/h3>&lt;p>可能是最为常见的一个废弃标记，通常用于标记函数或者变量在某个引擎版本后已被废弃了。&lt;/p>
&lt;p>语法为&lt;code>UE_DEPRECATED(引擎版本号, 提示消息)&lt;/code>，当在被废弃的版本之后的C++中，使用被废弃的变量或函数时，编译器和IDE会给出提示。&lt;/p>
&lt;h3 id="自定义废弃宏">&lt;a href="#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%ba%9f%e5%bc%83%e5%ae%8f" class="header-anchor">&lt;/a>自定义废弃宏
&lt;/h3>&lt;p>由于虚幻引擎的&lt;code>UE_DEPRECATED&lt;/code>是否废弃与引擎版本有关，在平常的项目里可能不太方便，因此可以自己封装一个废弃宏。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define META_DEPRECATED(...) [[deprecated(__VA_ARGS__ &amp;#34; This code has been marked as deprecated and may be deleted in subsequent versions. Please refer to the latest documentation for reference logic upgrade.&amp;#34;)]]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define META_DEPRECATED_DISABLE() META_WARNING_DISABLE(4996)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define META_DEPRECATED_ENABLE() META_WARNING_ENABLE()&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="参考文章">&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0" class="header-anchor">&lt;/a>参考文章
&lt;/h2>&lt;ul>
&lt;li>&lt;a class="link" href="https://squareys.de/blog/ue4-deprecating-symbols/" target="_blank" rel="noopener"
>UE4: Deprecating Symbols&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>虚幻引擎中的一些基础概念</title><link>https://boiltask.com/knowledge/ue/ue-knowledge-base/</link><pubDate>Mon, 08 Sep 2025 22:34:21 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/ue-knowledge-base/</guid><description>&lt;p>PureC++-反射&lt;/p>
&lt;p>Core-Editor-PIE-Runtime之间的关系。&lt;/p>
&lt;p>进程级的全局变量-GameInstance-Subsystem&lt;/p>
&lt;p>Framework-GameMode-GameState-Controller-Character&lt;/p>
&lt;h4 id="网络同步时对端异步加载资源">&lt;a href="#%e7%bd%91%e7%bb%9c%e5%90%8c%e6%ad%a5%e6%97%b6%e5%af%b9%e7%ab%af%e5%bc%82%e6%ad%a5%e5%8a%a0%e8%bd%bd%e8%b5%84%e6%ba%90" class="header-anchor">&lt;/a>网络同步时，对端异步加载资源
&lt;/h4>&lt;p>设置&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/unreal-engine-console-variables-reference" target="_blank" rel="noopener"
>net.AllowAsyncLoading&lt;/a>
为1，允许异步加载数据包中引用的未加载资产。&lt;/p>
&lt;p>如果为false，客户端将卡顿并立即加载资产，如果为true，数据包将在资产异步加载时延迟。可启用net.DelayUnmappedRPCs以延迟依赖于异步加载资产的RPC。&lt;/p></description></item><item><title>虚幻引擎中CommonUI插件</title><link>https://boiltask.com/knowledge/ue/plugin-common-ui/</link><pubDate>Sun, 07 Sep 2025 08:01:00 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/plugin-common-ui/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>CommonUI插件是UE5提供的一个方便丰富的、多层级的并且支持跨平台的用户界面的插件。&lt;/p>
&lt;h2 id="参考文档">&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e6%a1%a3" class="header-anchor">&lt;/a>参考文档
&lt;/h2>&lt;p>&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/common-ui-plugin-for-advanced-user-interfaces-in-unreal-engine" target="_blank" rel="noopener"
>适用于虚幻引擎高级用户界面的Common UI插件 | 虚幻引擎 5.6 文档 | Epic Developer Community&lt;/a>&lt;/p></description></item><item><title>Lyra设置页面相关设计</title><link>https://boiltask.com/knowledge/ue/lyra-setting-widget/</link><pubDate>Fri, 05 Sep 2025 12:59:55 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/lyra-setting-widget/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>在Lyra中，通过&lt;code>ESC&lt;/code>键选择&lt;code>OPTIONS&lt;/code>可以呼出设置页面&lt;code>W_LyraSettingScreen&lt;/code>。&lt;/p>
&lt;h2 id="页面分析">&lt;a href="#%e9%a1%b5%e9%9d%a2%e5%88%86%e6%9e%90" class="header-anchor">&lt;/a>页面分析
&lt;/h2>&lt;p>&lt;code>W_LyraSettingScreen&lt;/code>继承于C++类&lt;code>ULyraSettingScreen&lt;/code>，其基于&lt;code>GameSettings&lt;/code>插件提供的&lt;code>UGameSettingScreen&lt;/code>。&lt;/p>
&lt;pre class="mermaid">
classDiagram
class W_LyraSettingScreen {
+TopSettingsTabs
+Settings_Panel
+W_BottomActionBar
}
UCommonUserWidget &amp;lt;|-- UCommonActivatableWidget
UCommonActivatableWidget &amp;lt;|-- UGameSettingScreen
UGameSettingScreen &amp;lt;|-- ULyraSettingScreen
ULyraSettingScreen &amp;lt;|-- W_LyraSettingScreen
&lt;/pre>
&lt;p>其中，&lt;code>GameSettings&lt;/code>插件基于&lt;code>CommonUI&lt;/code>插件，详细说明参考：&lt;a class="link" href="https://boiltask.com/ue/plugin-common-ui" >虚幻引擎中CommonUI插件&lt;/a>&lt;/p>
&lt;h3 id="页头页签">&lt;a href="#%e9%a1%b5%e5%a4%b4%e9%a1%b5%e7%ad%be" class="header-anchor">&lt;/a>页头页签
&lt;/h3>&lt;p>标签控件使用一个&lt;code>ULyraTabListWidgetBase&lt;/code>制作，通过在C++中定义&lt;code>BindWidget&lt;/code>，可以创建一个在C++中可以访问的蓝图控件。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">UPROPERTY&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">BlueprintReadOnly&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Category&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Input&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">meta&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">BindWidget&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">OptionalWidget&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">AllowPrivateAccess&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">TObjectPtr&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">ULyraTabListWidgetBase&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">TopSettingsTabs&lt;/span>&lt;span class="p">;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这个控件在蓝图中被设为一个&lt;code>W_HorizontalTabList&lt;/code>，可以方便调整具体样式。&lt;/p>
&lt;blockquote>
&lt;p>可以参考：&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/coding-in-unreal-engine-blueprint-vs-cplusplus?application_version=5.5#combining-blueprint-and-c" target="_blank" rel="noopener"
>结合蓝图与C++&lt;/a>&lt;/p>&lt;/blockquote>
&lt;p>在页面的&lt;code>Construct&lt;/code>时，会调用&lt;code>RegisterTopLevelTab&lt;/code>来依次注册各个Tab。&lt;/p>
&lt;ul>
&lt;li>GameplayCollection&lt;/li>
&lt;li>VideoCollection&lt;/li>
&lt;li>AudioCollection&lt;/li>
&lt;li>MouseAndKeyboardCollection&lt;/li>
&lt;li>GamepadCollection&lt;/li>
&lt;/ul>
&lt;p>对于每个Tab，通过&lt;code>UGameSettingScreen::GetSettingCollection&lt;/code>读取具体的设置。&lt;/p>
&lt;p>具体的设置项依赖于&lt;code>GameSetting&lt;/code>提供的&lt;code>UGameSettingCollection&lt;/code>类。&lt;/p>
&lt;p>注册之后，只需要监听&lt;code>TopSettingsTabs&lt;/code>的&lt;code>OnTabSelected&lt;/code>即可在玩家选择对应页签时切换至所选&lt;code>Collection&lt;/code>。&lt;/p>
&lt;h3 id="页面内容">&lt;a href="#%e9%a1%b5%e9%9d%a2%e5%86%85%e5%ae%b9" class="header-anchor">&lt;/a>页面内容
&lt;/h3>&lt;p>这部分主要靠&lt;code>GameSettings&lt;/code>插件调度，在&lt;code>UGameSettingScreen&lt;/code>中定义了变量&lt;code>Settings_Panel&lt;/code>用于标记设置内容控件。&lt;/p>
&lt;p>&lt;code>Settings_Panel&lt;/code>是蓝图&lt;code>W_SettingsPanel&lt;/code>，其基于&lt;code>GameSettings&lt;/code>插件提供的&lt;code>UGameSettingPanel&lt;/code>。&lt;/p>
&lt;p>界面提供了设置项&lt;code>ListView_Settings&lt;/code>列表，以及设置项详情&lt;code>Details_Settings&lt;/code>。&lt;/p>
&lt;h3 id="页尾按钮">&lt;a href="#%e9%a1%b5%e5%b0%be%e6%8c%89%e9%92%ae" class="header-anchor">&lt;/a>页尾按钮
&lt;/h3>&lt;p>TODO&lt;/p></description></item><item><title>UnrealEngine中的在线异步任务管理器</title><link>https://boiltask.com/knowledge/ue/online-async-task-manage/</link><pubDate>Wed, 03 Sep 2025 13:22:36 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/online-async-task-manage/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>&lt;code>FOnlineAsyncTaskManager&lt;/code>是每个在线子系统中异步操作的基础。&lt;/p>
&lt;p>任务管理器在其自己的线程上运行，同时管理FOnlineAsyncTasks的串行队列和并行队列。&lt;/p>
&lt;p>对于串行队列，通过以下方式执行：&lt;/p>
&lt;ul>
&lt;li>游戏主线程&lt;code>GameThread&lt;/code>
&lt;ul>
&lt;li>初始化&lt;code>Initialize()&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>网络线程&lt;code>OnlineThread&lt;/code>
&lt;ul>
&lt;li>执行&lt;code>Tick()&lt;/code>直到&lt;code>IsDone()&lt;/code>&lt;/li>
&lt;li>将任务添加到出队列&lt;code>OutQueue&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>游戏主线程&lt;code>GameThread&lt;/code>
&lt;ul>
&lt;li>完成&lt;code>Finalize()&lt;/code>&lt;/li>
&lt;li>触发回调&lt;code>TriggerDelegates()&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>对于并行队列，流程与上述类似，不过其中的任务并不会等待先前的任务完成。&lt;/p></description></item><item><title>UnrealEngine中的在线子系统</title><link>https://boiltask.com/knowledge/ue/online-subsystem/</link><pubDate>Wed, 03 Sep 2025 12:45:19 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/online-subsystem/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>在线子系统（Online Subsystem）及其接口提供一种可访问Steam、Xbox Live、Facebook等在线服务功能的常用方法。开发一款在多平台上发行或支持多在线服务的游戏时，在线子系统可确保开发者唯一需要做的变更就是对所有支持的服务进行配置调整。&lt;/p>
&lt;h2 id="参考文档">&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e6%a1%a3" class="header-anchor">&lt;/a>参考文档
&lt;/h2>&lt;ul>
&lt;li>&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/online-subsystem-in-unreal-engine" target="_blank" rel="noopener"
>Online Subsystem in Unreal Engine | 虚幻引擎 5.6 文档 | Epic Developer Community&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>虚幻引擎适用于Unlua转到PuerTS的一些知识</title><link>https://boiltask.com/knowledge/ue/unlua-to-puerts/</link><pubDate>Tue, 19 Aug 2025 21:53:47 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/unlua-to-puerts/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>随着项目规模的扩大，越来越感觉&lt;code>Lua&lt;/code>脚本不受控制，因此尝试选择&lt;code>TypeScript&lt;/code>的脚本方案。&lt;/p>
&lt;p>因此，研究了一下&lt;code>PuerTS&lt;/code>的相关机制。&lt;/p>
&lt;p>体验下来，&lt;code>PuerTS&lt;/code>的方案确实上手难度比&lt;code>UnLua&lt;/code>高了很大一层，一方面是&lt;code>TypeScript&lt;/code>生态本就比&lt;code>Lua&lt;/code>复杂，另外&lt;code>PuerTS&lt;/code>也提供了足够的灵活性，选择一多在实际应用时反倒不太明确应该如何进展了。&lt;/p>
&lt;h2 id="qa">&lt;a href="#qa" class="header-anchor">&lt;/a>Q&amp;amp;A
&lt;/h2>&lt;h3 id="有没有最佳实践">&lt;a href="#%e6%9c%89%e6%b2%a1%e6%9c%89%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5" class="header-anchor">&lt;/a>有没有最佳实践
&lt;/h3>&lt;p>官方不提供更详细的例子，目前主要可以参考&lt;a class="link" href="https://github.com/chexiongsheng/puerts_unreal_demo" target="_blank" rel="noopener"
>puerts_unreal_demo&lt;/a>项目来了解到作者的一些设计。&lt;/p>
&lt;p>从各个论坛、文章分享中可以知道，官方不太希望更偏向&lt;code>UnLua&lt;/code>思路的&lt;code>继承引擎类&lt;/code>的功能。&lt;/p>
&lt;p>替代的，官方推荐自行启动虚拟机，并根据项目需要实现一套&lt;code>TypeScript&lt;/code>为主的&lt;code>Gameplay&lt;/code>框架。&lt;/p>
&lt;p>因此，对于习惯了&lt;code>UnLua&lt;/code>在蓝图声明一个模块来绑定脚本的开发者来说，切换到&lt;code>PuerTS&lt;/code>可能会不太适应，需要根据项目需求调整思路，&lt;/p>
&lt;p>参考Github Discussions&lt;a class="link" href="https://github.com/Tencent/puerts/discussions/1214" target="_blank" rel="noopener"
>1214&lt;/a>的思路，其实也能实现一套类似于&lt;code>UnLua&lt;/code>的自动绑定，不过确实就失去了一些&lt;code>TypeScript&lt;/code>类型检查的功能，可能还是需要搭配自动生成等机制来更好地维护。&lt;/p>
&lt;h3 id="mixin之后是否支持调用被覆写的函数">&lt;a href="#mixin%e4%b9%8b%e5%90%8e%e6%98%af%e5%90%a6%e6%94%af%e6%8c%81%e8%b0%83%e7%94%a8%e8%a2%ab%e8%a6%86%e5%86%99%e7%9a%84%e5%87%bd%e6%95%b0" class="header-anchor">&lt;/a>mixin之后是否支持调用被覆写的函数
&lt;/h3>&lt;p>不支持。&lt;/p>
&lt;p>参考作者回复：&lt;a class="link" href="https://github.com/Tencent/puerts/issues/1778" target="_blank" rel="noopener"
>https://github.com/Tencent/puerts/issues/1778&lt;/a>&lt;/p>
&lt;p>而对于继承引擎类的模式，生成的蓝图不建议修改（有可能被覆盖），因此也不适用于这种情况。&lt;/p>
&lt;h2 id="扩展插件">&lt;a href="#%e6%89%a9%e5%b1%95%e6%8f%92%e4%bb%b6" class="header-anchor">&lt;/a>扩展插件
&lt;/h2>&lt;p>根据UnLua的思路，编写了一个自动绑定JavaScript类的插件。&lt;/p>
&lt;p>可以参考：&lt;a class="link" href="https://github.com/BoilTask/PuertsAutoMixin" target="_blank" rel="noopener"
>BoilTask/PuertsAutoMixin&lt;/a>&lt;/p></description></item><item><title>虚幻引擎中打包Cook相关机制</title><link>https://boiltask.com/knowledge/ue/ue-why-to-cook/</link><pubDate>Wed, 13 Aug 2025 13:17:41 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/ue-why-to-cook/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>在&lt;code>UE&lt;/code>的打包中，可以看到一个用时较长的步骤是&lt;code>Cook&lt;/code>，下面具体分析一下这一步是做了哪些操作以及为什么。&lt;/p></description></item><item><title>UnrealEngine中的ShaderPipelineCache</title><link>https://boiltask.com/knowledge/ue/pso-cache/</link><pubDate>Fri, 01 Aug 2025 21:01:41 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/pso-cache/</guid><description>&lt;p>虚幻引擎中通过ShaderPipelineCache管理PSO缓存。&lt;/p></description></item><item><title>UnrealEngine中的ThreadHeartBeat机制</title><link>https://boiltask.com/knowledge/ue/thread-heart-beat/</link><pubDate>Fri, 01 Aug 2025 20:10:54 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/thread-heart-beat/</guid><description>&lt;h2 id="问题背景">&lt;a href="#%e9%97%ae%e9%a2%98%e8%83%8c%e6%99%af" class="header-anchor">&lt;/a>问题背景
&lt;/h2>&lt;p>有的时候会突然发现游戏进入了卡死状态，或者某个线程的任务一直没有处理完成，这个时候就需要考虑是不是线程出现了卡死，比如资源竞争、死循环等。通常情况下，我们可以提出一个监听线程来用心跳机制判断某个线程是否仍然存活，如果某个线程一段时间内都没有上报心跳，那么就可以认为它卡死了，这个时候可以打出堆栈或者直接让程序触发&lt;code>assert&lt;/code>。&lt;/p>
&lt;h2 id="机制简介">&lt;a href="#%e6%9c%ba%e5%88%b6%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>机制简介
&lt;/h2>&lt;p>在虚幻引擎中有一个&lt;code>FThreadHeartBeat&lt;/code>的类，用于维护线程心跳相关机制。&lt;/p>
&lt;p>主线程心跳：&lt;code>GameThreadHitchHeartBeat&lt;/code>。&lt;/p>
&lt;p>在引擎代码的各处，已经处理好了&lt;code>FThreadHeartBeat::Get().HeartBeat()&lt;/code>的调用，在一些不需要检测的地方，也调用了暂停检测。&lt;/p>
&lt;h2 id="核心思路">&lt;a href="#%e6%a0%b8%e5%bf%83%e6%80%9d%e8%b7%af" class="header-anchor">&lt;/a>核心思路
&lt;/h2>&lt;p>通过创建一个&lt;code>FThreadHeartBeat&lt;/code>的线程，定时检测参与心跳的其他线程上一次心跳的时间，如果超时则执行输出日志等操作。&lt;/p>
&lt;p>还需要记录下来上一次卡死（Hang）的时间，避免重复地检测上报。&lt;/p>
&lt;p>如果需要获取目标线程的堆栈，可以使用&lt;code>FPlatformStackWalk::CaptureThreadStackBackTrace&lt;/code>来获取指定线程的当前堆栈。&lt;/p>
&lt;p>特殊的，对于渲染的检测，直接进行&lt;code>Crash&lt;/code>。&lt;/p>
&lt;h2 id="如何使用">&lt;a href="#%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8" class="header-anchor">&lt;/a>如何使用
&lt;/h2>&lt;h3 id="开启配置">&lt;a href="#%e5%bc%80%e5%90%af%e9%85%8d%e7%bd%ae" class="header-anchor">&lt;/a>开启配置
&lt;/h3>&lt;p>核心功能只需要在&lt;code>DefaultEngine.ini&lt;/code>中配置上对应的检测时间，即可对主线程的死锁进行检测：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="k">[Core.System]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">HangDuration&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">15.0&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>需要注意默认的宏控制为：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define USE_HANG_DETECTION (ALLOW_HANG_DETECTION &amp;amp;&amp;amp; !WITH_EDITORONLY_DATA &amp;amp;&amp;amp; !IS_PROGRAM &amp;amp;&amp;amp; !UE_BUILD_DEBUG &amp;amp;&amp;amp; !ENABLE_PGO_PROFILE &amp;amp;&amp;amp; !USING_THREAD_SANITISER &amp;amp;&amp;amp; !USING_INSTRUMENTATION)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>也即如果是&lt;code>Editor&lt;/code>环境下，不会开启，如果想要测试可以把&lt;code>&amp;amp;&amp;amp; !WITH_EDITORONLY_DATA&lt;/code>删除掉重新编译。&lt;/p>
&lt;h3 id="自定义线程">&lt;a href="#%e8%87%aa%e5%ae%9a%e4%b9%89%e7%ba%bf%e7%a8%8b" class="header-anchor">&lt;/a>自定义线程
&lt;/h3>&lt;p>如果需要检测其他的线程，只需要在对应线程的Tick中调用&lt;code>FThreadHeartBeat::HeartBeat()&lt;/code>让心跳线程记录下来即可。&lt;/p>
&lt;h3 id="长时间任务">&lt;a href="#%e9%95%bf%e6%97%b6%e9%97%b4%e4%bb%bb%e5%8a%a1" class="header-anchor">&lt;/a>长时间任务
&lt;/h3>&lt;p>有的时候，我们需要明确地长时间执行一个任务，这个时候可以使用&lt;code>FSlowHeartBeatScope&lt;/code>类来构造一个锁，让检测线程知道目前处于一个明确地不需要检测的时间段。&lt;/p>
&lt;p>他的原理就是在构造函数的时候，调用&lt;code>FThreadHeartBeat::SuspendHeartBeat&lt;/code>标记&lt;code>SuspendedCount++&lt;/code>，析构的时候调用&lt;code>FThreadHeartBeat::ResumeHeartBeat&lt;/code>标记&lt;code>--SuspendedCount&lt;/code>。&lt;/p>
&lt;p>在检测的时候，只会处理&lt;code>SuspendedCount == 0&lt;/code>的线程。&lt;/p>
&lt;h2 id="参考文档">&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e6%a1%a3" class="header-anchor">&lt;/a>参考文档
&lt;/h2>&lt;p>&lt;a class="link" href="https://zhuanlan.zhihu.com/p/648030201" target="_blank" rel="noopener"
>Unreal心跳机制调研 - 知乎&lt;/a>&lt;/p></description></item><item><title>UE5中的CommonLoadingScreen插件</title><link>https://boiltask.com/knowledge/ue/common-loading-screen/</link><pubDate>Mon, 28 Jul 2025 13:10:54 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/common-loading-screen/</guid><description>&lt;blockquote>
&lt;p>本文基于&lt;code>UE5.6&lt;/code>版本的&lt;code>Lyra&lt;/code>中的&lt;code>CommonLoadingScreen&lt;/code>编写。&lt;/p>&lt;/blockquote>
&lt;h2 id="基本概念">&lt;a href="#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" class="header-anchor">&lt;/a>基本概念
&lt;/h2>&lt;p>&lt;code>CommonLoadingScreen&lt;/code>是一个用户快速创建Loading界面的插件，在Lyra项目中发布。&lt;/p>
&lt;p>引入插件之后会附带一个&lt;code>ULoadingScreenManager&lt;/code>的&lt;code>UGameInstanceSubsystem&lt;/code>，会跟随&lt;code>GameInstance&lt;/code>进行初始化。&lt;/p>
&lt;p>在&lt;code>ShouldCreateSubsystem&lt;/code>中判断了，如果是在&lt;code>DedicatedServer&lt;/code>则不创建。&lt;/p>
&lt;p>在&lt;code>ULoadingScreenManager::Tick&lt;/code>中，会进行&lt;code>UpdateLoadingScreen&lt;/code>的判断从而更新&lt;code>Loading&lt;/code>的显隐状态。&lt;/p>
&lt;h2 id="loading控制">&lt;a href="#loading%e6%8e%a7%e5%88%b6" class="header-anchor">&lt;/a>Loading控制
&lt;/h2>&lt;p>核心是判断是否处于Loading状态，会判断各种需要Loading的情况，如果任意一个达成则认为需要展示&lt;code>Loading&lt;/code>（在此之前还会判断一些不需要&lt;code>Loading&lt;/code>的情况）。&lt;/p>
&lt;p>判断不需要Loading的情况：&lt;/p>
&lt;ul>
&lt;li>如果命令行设置了不展示&lt;code>Loading&lt;/code>的&lt;code>NoLoadingScreen&lt;/code>，则认为不需要&lt;code>Loading&lt;/code>。&lt;/li>
&lt;li>如果&lt;code>GameVieportClient&lt;/code>处于&lt;code>nullptr&lt;/code>则不需要&lt;code>Loading&lt;/code>。&lt;/li>
&lt;/ul>
&lt;p>判断需要Loading的情况：&lt;/p>
&lt;ul>
&lt;li>如果设置了&lt;code>ForceLoadingScreenVisible&lt;/code>，则认为需要&lt;/li>
&lt;li>如果从&lt;code>GameInstance&lt;/code>取不到&lt;code>WorldContext&lt;/code>&lt;/li>
&lt;li>如果从&lt;code>WorldContext&lt;/code>取不到&lt;code>World&lt;/code>&lt;/li>
&lt;li>如果取不到&lt;code>GameState&lt;/code>&lt;/li>
&lt;li>如果地图处于加载状态&lt;/li>
&lt;li>如果场景处于待传送状态&lt;/li>
&lt;li>如果场景处于待连接网络状态&lt;/li>
&lt;li>如果&lt;code>World&lt;/code>还没有&lt;code>BeginPlay&lt;/code>&lt;/li>
&lt;li>如果&lt;code>World&lt;/code>处于流式传送中&lt;/li>
&lt;li>如果&lt;code>GameState&lt;/code>重写了应该&lt;code>Loading&lt;/code>&lt;/li>
&lt;li>如果&lt;code>GameState上&lt;/code>的&lt;code>Component&lt;/code>重写了应该&lt;code>Loading&lt;/code>&lt;/li>
&lt;li>如果设置的&lt;code>ExternalLoadingProcessors&lt;/code>重写了应该&lt;code>Loading&lt;/code>&lt;/li>
&lt;li>如果&lt;code>PlayerController&lt;/code>重写了应该&lt;code>Loading&lt;/code>&lt;/li>
&lt;li>如果&lt;code>PlayerController&lt;/code>上的&lt;code>Component&lt;/code>重写了应该&lt;code>Loading&lt;/code>&lt;/li>
&lt;li>如果处于分屏游戏并且存在无效的&lt;code>PlayerController&lt;/code>&lt;/li>
&lt;li>如果没有任何&lt;code>PlaayerController&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>思路上，提供给用户自定义主要靠&lt;code>ILoadingProcessInterface&lt;/code>接口，可以实现是否应该Loading的判断，任意一个返回需要&lt;code>Loading&lt;/code>则最终会处于&lt;code>Loading&lt;/code>状态。&lt;/p>
&lt;h2 id="设计分析">&lt;a href="#%e8%ae%be%e8%ae%a1%e5%88%86%e6%9e%90" class="header-anchor">&lt;/a>设计分析
&lt;/h2>&lt;h3 id="判断地图加载状态">&lt;a href="#%e5%88%a4%e6%96%ad%e5%9c%b0%e5%9b%be%e5%8a%a0%e8%bd%bd%e7%8a%b6%e6%80%81" class="header-anchor">&lt;/a>判断地图加载状态
&lt;/h3>&lt;p>在&lt;code>ULoadingScreenManager::Initialize&lt;/code>中注册了加载地图前的事件&lt;code>PreLoadMapWithContext&lt;/code>与加载完成的事件&lt;code>PostLoadMapWithWorld&lt;/code>，从而在传送地图的时机进行一些处理。&lt;/p>
&lt;blockquote>
&lt;p>注意&lt;code>FCoreUObjectDelegates&lt;/code>的对象是进程级的，如果以多玩家的方式运行，此时有可能会触发非本&lt;code>GameInstance&lt;/code>的回调，需要判断&lt;code>World&lt;/code>的&lt;code>GameInstance&lt;/code>是否是本&lt;code>GameInstance&lt;/code>。&lt;/p>&lt;/blockquote>
&lt;p>在&lt;code>PreLoadMapWithContext&lt;/code>时，标记此时处于&lt;code>LoadMap&lt;/code>状态。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">bCurrentlyInLoadMap&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在&lt;code>PostLoadMapWithWorld&lt;/code>时，标记此时已不处于&lt;code>LoadMap&lt;/code>状态。&lt;/p>
&lt;h3 id="输出为何处于loading状态">&lt;a href="#%e8%be%93%e5%87%ba%e4%b8%ba%e4%bd%95%e5%a4%84%e4%ba%8eloading%e7%8a%b6%e6%80%81" class="header-anchor">&lt;/a>输出为何处于Loading状态
&lt;/h3>&lt;p>在&lt;code>Tick&lt;/code>时会进行判断，每达到一个&lt;code>LogLoadingScreenHeartbeatInterval&lt;/code>（或者标记了&lt;code>LogLoadingScreenReasonEveryFrame&lt;/code>），将输出&lt;code>Loading&lt;/code>状态的原因（如果标记了&lt;code>LogLoadingScreenReasonEveryFrame&lt;/code>还会输出不需要的原因）。&lt;/p>
&lt;p>为此，每次判断是否需要展示&lt;code>Loading&lt;/code>时，需要把原因记录在&lt;code>DebugReasonForShowingOrHidingLoadingScreen&lt;/code>中。&lt;/p>
&lt;h3 id="调整渲染设置">&lt;a href="#%e8%b0%83%e6%95%b4%e6%b8%b2%e6%9f%93%e8%ae%be%e7%bd%ae" class="header-anchor">&lt;/a>调整渲染设置
&lt;/h3>&lt;p>为了节约性能，在&lt;code>Loading&lt;/code>的时候会调整一些渲染的设置。&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://boiltask.com/knowledge/ue/pso-cache" >ShaderPipelineCache::SetBatchMode&lt;/a>设置为Fast，关闭时还原回Background&lt;/li>
&lt;li>设置bDisableWorldRendering禁用世界渲染&lt;/li>
&lt;li>设置处于HighPriorityLoading高优先级加载模式&lt;/li>
&lt;li>调整线程心跳延迟系数&lt;/li>
&lt;li>暂停主线程心跳判断&lt;/li>
&lt;/ul>
&lt;h3 id="拦截input">&lt;a href="#%e6%8b%a6%e6%88%aainput" class="header-anchor">&lt;/a>拦截Input
&lt;/h3>&lt;p>通过在创建&lt;code>Loading&lt;/code>时，注册了一个&lt;code>InputPreProcessor&lt;/code>来实现输入拦截。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">InputPreProcessor&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">MakeShareable&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">FLoadingScreenInputPreProcessor&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">FLoadingScreenInputPreProcessor&lt;/span>&lt;span class="p">());&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">FSlateApplication&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">Get&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">RegisterInputPreProcessor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">InputPreProcessor&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="调整线程心跳">&lt;a href="#%e8%b0%83%e6%95%b4%e7%ba%bf%e7%a8%8b%e5%bf%83%e8%b7%b3" class="header-anchor">&lt;/a>调整线程心跳
&lt;/h3>&lt;p>在&lt;code>Loading&lt;/code>的控制流程里，通过调用&lt;code>FThreadHeartBeat&lt;/code>上的接口来控制线程心跳。&lt;/p>
&lt;p>详情可参考：&lt;a class="link" href="https://boiltask.com/knowledge/ue/thread-heart-beat/" >UnrealEngine 中的 ThreadHeartBeat 机制&lt;/a>&lt;/p>
&lt;h3 id="界面刷新">&lt;a href="#%e7%95%8c%e9%9d%a2%e5%88%b7%e6%96%b0" class="header-anchor">&lt;/a>界面刷新
&lt;/h3>&lt;p>通过调用一次&lt;code>SlateApplication&lt;/code>的Tick函数，来确保&lt;code>Loading&lt;/code>界面立刻刷新。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Tick Slate to make sure the loading screen is displayed immediately
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">FSlateApplication&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">Get&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">Tick&lt;/span>&lt;span class="p">();&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在界面隐藏时，会立即调用一次GC函数，确保&lt;code>Loading&lt;/code>界面销毁（感觉这个倒是意义不太明显）。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">GEngine&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">ForceGarbageCollection&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="p">);&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="总结">&lt;a href="#%e6%80%bb%e7%bb%93" class="header-anchor">&lt;/a>总结
&lt;/h2>&lt;p>设计思路上，&lt;code>CommonLoadingScreen&lt;/code>不是采用需要&lt;code>Loading&lt;/code>时调用&lt;code>Loading&lt;/code>，而是采用了判断需要&lt;code>Loading&lt;/code>状态时创建&lt;code>Loading&lt;/code>。这一设计有利于处理当同时有多个&lt;code>Loading&lt;/code>逻辑需要调用时，如何控制最终的&lt;code>Loading&lt;/code>状态。同时借助良好的&lt;code>Debug&lt;/code>埋点，可以方便的知道此时&lt;code>Loading&lt;/code>的具体原因。&lt;/p></description></item><item><title>Lyra中Loading界面的创建</title><link>https://boiltask.com/knowledge/ue/lyra-loading-ui/</link><pubDate>Mon, 28 Jul 2025 13:01:12 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/lyra-loading-ui/</guid><description>&lt;p>在打开游戏地图之后，会发现首先打开了Loading界面，下面分析Loading界面的相关机制&lt;/p>
&lt;p>&lt;img src="https://r2.boiltask.com/2025/07/2ec341c6fd901bc93ff7a8570b35609c.png"
loading="lazy"
alt="image.png"
>&lt;/p>
&lt;p>通过定位，发现所展示的界面为&lt;code>W_LoadingScreen_Host&lt;/code>。&lt;/p>
&lt;blockquote>
&lt;p>由于Loading时间较短不好捕获，因此全局搜了一下Loading并通过修改界面的方式确定就是此界面。&lt;/p>&lt;/blockquote>
&lt;p>查找界面引用，并没有发现存在蓝图直接引用，因此猜测是配置在了Config中。&lt;/p>
&lt;p>搜索发现为&lt;code>CommonLoadingScreen&lt;/code>插件所提供的配置。&lt;/p>
&lt;p>&lt;img src="https://r2.boiltask.com/2025/07/00893d0706eb8482b5fd9a7c4de009f6.png"
loading="lazy"
alt="image.png"
>&lt;/p>
&lt;p>下面详细分析&lt;code>CommonLoadingScreen&lt;/code>插件的相关逻辑：&lt;/p>
&lt;p>&lt;a class="link" href="https://boiltask.com/knowledge/ue/common-loading-screen" >UE5中的CommonLoadingScreen插件&lt;/a>&lt;/p></description></item><item><title>UE插件上传Fab的一些心得</title><link>https://boiltask.com/knowledge/fab-ue-plugin-publish/</link><pubDate>Sun, 06 Apr 2025 12:23:15 +0800</pubDate><guid>https://boiltask.com/knowledge/fab-ue-plugin-publish/</guid><description>&lt;p>之前制作事件插件上传到Fab平台时遇见了一些麻烦，在这里记录一下。&lt;/p></description></item><item><title>虚幻引擎中ASan相关机制</title><link>https://boiltask.com/knowledge/ue/ue-asan/</link><pubDate>Thu, 03 Apr 2025 09:03:48 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/ue-asan/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>在排查一些内存问题（野指针、越界访问等）时，可以使用AddressSanitizer（ASan）工具。&lt;/p>
&lt;p>比起修改为Stomp分配器的方式，ASan的实现以性能降低约一半的代价，也能扫描出来很多问题。&lt;/p>
&lt;p>性能指标参考：&lt;a class="link" href="https://github.com/google/sanitizers/wiki/AddressSanitizerPerformanceNumbers" target="_blank" rel="noopener"
>AddressSanitizerPerformanceNumbers · google/sanitizers Wiki&lt;/a>&lt;/p>
&lt;h2 id="linux下ds使用">&lt;a href="#linux%e4%b8%8bds%e4%bd%bf%e7%94%a8" class="header-anchor">&lt;/a>Linux下DS使用
&lt;/h2>&lt;h3 id="基本流程">&lt;a href="#%e5%9f%ba%e6%9c%ac%e6%b5%81%e7%a8%8b" class="header-anchor">&lt;/a>基本流程
&lt;/h3>&lt;p>考虑开启 &lt;code>ASan&lt;/code> 对流程和性能的影响，一般需要单独部署一些炮灰环境。&lt;/p>
&lt;ol>
&lt;li>在原有的打包参数之后添加&lt;code>-EnableAsan&lt;/code>标识，用来开启&lt;code>ASan&lt;/code>相关的编译参数&lt;/li>
&lt;li>启动时通过设置环境变量&lt;code>ASAN_OPTIONS&lt;/code>来控制ASan的相关配置&lt;/li>
&lt;li>在原先的启动参数之后加上&lt;code>-ansimalloc&lt;/code>标识&lt;/li>
&lt;li>当遇见异常时，检查&lt;code>stderr&lt;/code>的输出&lt;/li>
&lt;li>可以选择配置&lt;code>log_path&lt;/code>来指定异常时的输出文件&lt;/li>
&lt;/ol>
&lt;h3 id="堆栈获取">&lt;a href="#%e5%a0%86%e6%a0%88%e8%8e%b7%e5%8f%96" class="header-anchor">&lt;/a>堆栈获取
&lt;/h3>&lt;p>通过指定&lt;code>ASAN_SYMBOLIZER_PATH&lt;/code>可以使得输出的信息里自带堆栈，使用了llvm- symbolizer ，性能比起addr2line可以有较高的提升。&lt;/p>
&lt;p>详见：&lt;a class="link" href="https://github.com/google/sanitizers/wiki/AddressSanitizerCallStack" target="_blank" rel="noopener"
>AddressSanitizerCallStack · google/sanitizers Wiki&lt;/a>&lt;/p>
&lt;p>会使得输出日志稍微慢几秒，目测可以接受。&lt;/p>
&lt;p>可以使用格式文本设定&lt;code>stack_trace_format&lt;/code>：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C++" data-lang="C++">&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// %% - represents a &amp;#39;%&amp;#39; character;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %n - frame number (copy of frame_no);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %p - PC in hex format;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %m - path to module (binary or shared object);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %o - offset in the module in hex format;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %f - function name;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %q - offset in the function in hex format (*if available*);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %s - path to source file;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %l - line in the source file;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %c - column in the source file;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %F - if function is known to be &amp;lt;foo&amp;gt;, prints &amp;#34;in &amp;lt;foo&amp;gt;&amp;#34;, possibly
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// followed by the offset in this function, but only if source file
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// is unknown;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %S - prints file/line/column information;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %L - prints location information: file/line/column, if it is known, or
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// module+offset if it is known, or (&amp;lt;unknown module&amp;gt;) string.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// %M - prints module basename and offset, if it is known, or PC.
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>不过测试下来似乎未取到函数行号，判断是&lt;code>llvm&lt;/code>的问题，&lt;code>addr2line&lt;/code>就可以。&lt;/p>
&lt;p>&lt;code>windows&lt;/code>下使用&lt;code>llvm-symbolizer.exe&lt;/code>也可以成功取到。&lt;/p>
&lt;p>同时，测试下来&lt;code>windows&lt;/code>下使用&lt;code>MinGW&lt;/code>版本的&lt;code>addr2line&lt;/code>也可以取到堆栈，但是慢到无法接收。&lt;/p>
&lt;h3 id="推荐配置">&lt;a href="#%e6%8e%a8%e8%8d%90%e9%85%8d%e7%bd%ae" class="header-anchor">&lt;/a>推荐配置
&lt;/h3>&lt;p>开启堆栈输出并设置日志路径：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-Bash" data-lang="Bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">ASAN_OPTIONS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;symbolize=1:print_stacktrace=1:log_path=/home/crash/ds-&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">版本&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">-asan-crash.log&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="问题记录">&lt;a href="#%e9%97%ae%e9%a2%98%e8%ae%b0%e5%bd%95" class="header-anchor">&lt;/a>问题记录
&lt;/h2>&lt;h3 id="开启asan之后加载过慢">&lt;a href="#%e5%bc%80%e5%90%afasan%e4%b9%8b%e5%90%8e%e5%8a%a0%e8%bd%bd%e8%bf%87%e6%85%a2" class="header-anchor">&lt;/a>开启ASan之后加载过慢
&lt;/h3>&lt;p>需要检查&lt;code>fast_unwind_on_malloc&lt;/code>是否被设置为0，如果&lt;code>fast_unwind_on_malloc&lt;/code>被关闭，则会极大地影响性能。&lt;/p>
&lt;p>详见：&lt;a class="link" href="https://developer.android.google.cn/ndk/guides/asan?hl=zh-cn#stack-traces" target="_blank" rel="noopener"
>Address Sanitizer  |  Android NDK  |  Android Developers&lt;/a>&lt;/p>
&lt;h2 id="堆栈还原">&lt;a href="#%e5%a0%86%e6%a0%88%e8%bf%98%e5%8e%9f" class="header-anchor">&lt;/a>堆栈还原
&lt;/h2>&lt;p>写了一个&lt;code>golang&lt;/code>的脚本用于快速的分析堆栈：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;bufio&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;os&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;os/exec&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;strings&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">convertStackToAddr2line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">inputFile&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">outputFile&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">binaryPath&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">error&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">infile&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">inputFile&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;无法打开输入文件: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">infile&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">File&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">infile&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;关闭输入文件时出错: %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}(&lt;/span>&lt;span class="nx">infile&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">outfile&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Create&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">outputFile&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;无法创建输出文件: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">outfile&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">File&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">outfile&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;关闭输出文件时出错: %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}(&lt;/span>&lt;span class="nx">outfile&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">scanner&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">bufio&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewScanner&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">infile&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">writer&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">bufio&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewWriter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">outfile&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">writer&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">bufio&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Writer&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">writer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Flush&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;刷新输出文件时出错: %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}(&lt;/span>&lt;span class="nx">writer&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">scanner&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Scan&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">line&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">TrimSpace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">scanner&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Text&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">HasPrefix&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;#&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">parts&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fields&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">line&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">address&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">part&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">parts&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">HasPrefix&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">part&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0x&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">address&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">part&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">address&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">cmd&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">exec&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Command&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;addr2line&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;-e&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">binaryPath&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">address&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">output&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">cmd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Output&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Stderr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;执行 addr2line 失败: %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">continue&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">TrimSpace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">output&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">writer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WriteString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;\n&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">writer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WriteString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">line&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;\n&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">line&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">scanner&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Err&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;读取文件时出错: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;转换完成，结果已保存到 %s\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">outputFile&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Args&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Usage: go run main.go &amp;lt;input_file&amp;gt; &amp;lt;output_file&amp;gt; &amp;lt;binary_path&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">inputFile&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Args&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">outputFile&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Args&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">binaryPath&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Args&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">convertStackToAddr2line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">inputFile&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">outputFile&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">binaryPath&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Stderr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;错误: %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="参考文章">&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0" class="header-anchor">&lt;/a>参考文章
&lt;/h2>&lt;ul>
&lt;li>&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/using-clang-sanitizers-in-unreal-engine-projects" target="_blank" rel="noopener"
>在虚幻引擎项目中使用Clang检测工具 | 虚幻引擎 5.5 文档 | Epic Developer Community&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://github.com/google/sanitizers" target="_blank" rel="noopener"
>google/sanitizers: AddressSanitizer, ThreadSanitizer, MemorySanitizer&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://forums.unrealengine.com/t/addresssanitizer-can-output-stacktrace-on-android-debug-buildconfiguration-but-not-development/690919" target="_blank" rel="noopener"
>AddressSanitizer can output Stacktrace on android debug buildconfiguration but not development? - International - Epic Developer Community Forums&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>虚幻引擎中网络角色Role相关概念</title><link>https://boiltask.com/knowledge/ue/network-role/</link><pubDate>Wed, 02 Apr 2025 13:17:46 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/network-role/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>在Actor的复制过程中，需要关心两个属性，Role与RemoteRole。&lt;/p>
&lt;p>通过这两个属性，可以明确地知道：&lt;/p>
&lt;ul>
&lt;li>谁拥有Actor的主控权&lt;/li>
&lt;li>Actor是否被复制&lt;/li>
&lt;li>复制模式&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>首先一件要确定的事，就是谁拥有特定 actor 的主控权。要确定当前运行的引擎实例是否有主控者，需要查看 Role 属性是否为 &lt;code>ROLE_Authority&lt;/code>。如果是，就表明这个运行中的 &lt;strong>虚幻引擎&lt;/strong> 实例负责掌管此 actor（决定其是否被复制）。&lt;/p>
&lt;p>如果 Role 是 &lt;code>ROLE_Authority&lt;/code>，RemoteRole 是 &lt;code>ROLE_SimulatedProxy&lt;/code> 或 &lt;code>ROLE_AutonomousProxy&lt;/code>，就说明这个引擎实例负责将此 actor 复制到远程连接。&lt;/p>&lt;/blockquote>
&lt;p>简单来说：&lt;/p>
&lt;p>对于单机模式，Actor的Role与RemoteRole很显然都是ROLE_Authority。&lt;/p>
&lt;p>对于网络模型下，Role代表本地对于Actor的角色，RemoteRole代表对端对于Actor的角色。&lt;/p>
&lt;p>下面将重点描述多人游戏时的相关机制。&lt;/p>
&lt;h2 id="属性类型">&lt;a href="#%e5%b1%9e%e6%80%a7%e7%b1%bb%e5%9e%8b" class="header-anchor">&lt;/a>属性类型
&lt;/h2>&lt;h3 id="role_authority">&lt;a href="#role_authority" class="header-anchor">&lt;/a>ROLE_Authority
&lt;/h3>&lt;p>代表最高权限，通常是服务器持有的状态。&lt;/p>
&lt;p>如果客户端本地生成的一个不同步的Actor，其Role有可能也为ROLE_Authority，因为此时这个客户端对这个Actor具有绝对的权限。&lt;/p>
&lt;h3 id="role_simulatedproxy">&lt;a href="#role_simulatedproxy" class="header-anchor">&lt;/a>ROLE_SimulatedProxy
&lt;/h3>&lt;p>被动模拟角色，由服务器控制，客户端仅接受同步数据。&lt;/p>
&lt;p>比如对于客户端A视角下的另一个角色，它的Role就有可能是ROLE_SimulatedProxy。&lt;/p>
&lt;h3 id="role_autonomousproxy">&lt;a href="#role_autonomousproxy" class="header-anchor">&lt;/a>ROLE_AutonomousProxy
&lt;/h3>&lt;p>主控端角色，通常代表由客户端直接控制，服务器接收控制的输入来同步其状态。&lt;/p>
&lt;p>比如对于客户端A视角下的自身角色，它的Role就有可能是ROLE_AutonomousProxy，接收输入之后发给服务器更新其状态。&lt;/p>
&lt;h2 id="remoterole与role的区别">&lt;a href="#remoterole%e4%b8%8erole%e7%9a%84%e5%8c%ba%e5%88%ab" class="header-anchor">&lt;/a>RemoteRole与Role的区别
&lt;/h2>&lt;p>RemoteRole与Role对应，代表对端对Actor的角色定义，是Role的另一个视角。&lt;/p>
&lt;p>当Actor在服务器为ROLE_Authority，他在服务器上的RemoteRole为ROLE_SimulatedProxy，对应的客户端的Role为ROLE_SimulatedProxy，RemoteRole为ROLE_Authority。&lt;/p>
&lt;p>对于不同的数值观察者，它们的 Role 和 RemoteRole 值&lt;strong>可能&lt;/strong>发生对调。&lt;/p>
&lt;blockquote>
&lt;p>注意这个可能的描述&lt;/p>
&lt;p>比如客户端Role为ROLE_AutonomousProxy，RemoteRole为ROLE_Authority的角色（自己操作的那个），他在服务器上的Role为ROLE_Authority，但是RemoteRole可能为ROLE_SimulatedProxy。&lt;/p>&lt;/blockquote>
&lt;h2 id="角色组合">&lt;a href="#%e8%a7%92%e8%89%b2%e7%bb%84%e5%90%88" class="header-anchor">&lt;/a>角色组合
&lt;/h2>&lt;h3 id="常见role与remoterole的组合">&lt;a href="#%e5%b8%b8%e8%a7%81role%e4%b8%8eremoterole%e7%9a%84%e7%bb%84%e5%90%88" class="header-anchor">&lt;/a>常见Role与RemoteRole的组合
&lt;/h3>&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">&lt;strong>本地Role&lt;/strong>&lt;/th>
&lt;th style="text-align: center">&lt;strong>远程RemoteRole&lt;/strong>&lt;/th>
&lt;th style="text-align: center">&lt;strong>场景说明&lt;/strong>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">ROLE_Authority&lt;/td>
&lt;td style="text-align: center">ROLE_SimulatedProxy&lt;/td>
&lt;td style="text-align: center">服务器视角，控制Actor，客户端仅接收同步数据（如NPC）。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">ROLE_SimulatedProxy&lt;/td>
&lt;td style="text-align: center">ROLE_Authority&lt;/td>
&lt;td style="text-align: center">客户端视角，客户端接收服务器同步的Actor（如静态场景物体）。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">ROLE_AutonomousProxy&lt;/td>
&lt;td style="text-align: center">ROLE_SimulatedProxy&lt;/td>
&lt;td style="text-align: center">客户端视角，客户端控制Actor，服务器同步其状态（如玩家角色）。&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="区分simulatedproxy与autonomousproxy">&lt;a href="#%e5%8c%ba%e5%88%86simulatedproxy%e4%b8%8eautonomousproxy" class="header-anchor">&lt;/a>区分SimulatedProxy与AutonomousProxy
&lt;/h2>&lt;p>参考官方文档的描述，由于Actor的同步具有间隔，为了弥补这个缺陷，客户端在模拟时采取两种策略：&lt;/p>
&lt;p>ROLE_SimulatedProxy通常直接根据服务器同步的信息进行模拟。&lt;/p>
&lt;p>ROLE_AutonomousProxy通常会考虑客户端自身的输入，通过这部分输入来补足信息，而非只通过服务器的信息推算。&lt;/p>
&lt;h2 id="参考文档">&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e6%a1%a3" class="header-anchor">&lt;/a>参考文档
&lt;/h2>&lt;ul>
&lt;li>&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/actor-role-and-remote-role-in-unreal-engine" target="_blank" rel="noopener"
>虚幻引擎Actor的 Role 和 RemoteRole属性 | 虚幻引擎 5.5 文档 | Epic Developer Community&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>虚幻引擎中角色移动相关机制</title><link>https://boiltask.com/knowledge/ue/character-movement/</link><pubDate>Wed, 02 Apr 2025 12:54:31 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/character-movement/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>本文主要用于整理虚幻引擎中移动相关的机制。&lt;/p>
&lt;p>内容可能摘录自各个文章、论坛、文档等，仅用作记录。&lt;/p>
&lt;h2 id="基础简介">&lt;a href="#%e5%9f%ba%e7%a1%80%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>基础简介
&lt;/h2>&lt;p>移动是一个非常重要并且较为复杂的模块，&lt;code>UnrealEngine&lt;/code>对于移动的实现使用了组合模式，在描述&lt;code>Actor&lt;/code>的移动时，含义是具有移动组件的&lt;code>Actor&lt;/code>可以移动。&lt;/p>
&lt;p>移动组件的基类为&lt;code>UMovementComponent&lt;/code>，提供基本的移动功能，有多个不同功能的子类，一些子类移动组件专门用于服务一种特殊的&lt;code>Actor&lt;/code>，比如通常代表玩家的&lt;code>ACharacter&lt;/code>，对应的移动组件&lt;code>UCharacterMovementComponent&lt;/code>。&lt;/p>
&lt;p>&lt;code>Actor&lt;/code>虽然代表在&lt;code>World&lt;/code>中的一个实体，但是本身是没有位置概念的。&lt;code>Actor&lt;/code>的位置由其具有的&lt;code>USceneComponent&lt;/code>赋予。因此移动的本质，就是改变&lt;code>Actor&lt;/code>上的某个&lt;code>USceneComponent&lt;/code>的位置，通常指的是&lt;code>Actor&lt;/code>的&lt;code>RootComponent&lt;/code>。&lt;/p>
&lt;p>&lt;code>UMovementComponent&lt;/code>上有个属性&lt;code>UpdatedComponent&lt;/code>，就是用于设置移动组件所修改的&lt;code>USceneComponent&lt;/code>。暴露给蓝图有个参数&lt;code>bAutoRegisterUpdatedComponent&lt;/code>，如果设置为&lt;code>true&lt;/code>，则会在组件初始化时，读取&lt;code>Owner&lt;/code>的&lt;code>RootComponent&lt;/code>，调用&lt;code>SetUpdatedComponent&lt;/code>设置&lt;code>UpdatedComponent&lt;/code>。&lt;/p>
&lt;h2 id="移动流程">&lt;a href="#%e7%a7%bb%e5%8a%a8%e6%b5%81%e7%a8%8b" class="header-anchor">&lt;/a>移动流程
&lt;/h2>&lt;p>网络同步下的角色移动至少需要考虑以下几个方面：&lt;/p>
&lt;ul>
&lt;li>玩家客户端操作无延迟
&lt;ul>
&lt;li>需要直接响应移动输入并上报给服务器&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>位置以服务器为准
&lt;ul>
&lt;li>防止外挂&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>同步到的移动需要表现丝滑
&lt;ul>
&lt;li>不可能每帧都收到位置更新，需要适当进行插值&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="自主实现">&lt;a href="#%e8%87%aa%e4%b8%bb%e5%ae%9e%e7%8e%b0" class="header-anchor">&lt;/a>自主实现
&lt;/h3>&lt;p>先思考如果自己实现的情况下可能会怎么做。&lt;/p>
&lt;ul>
&lt;li>本地接收到输入之后，在本地先操作移动，同时把移动的操作发送给服务器
&lt;ul>
&lt;li>可能包含的信息是：当前位置、目标位置等&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>服务器接收到移动的操作，在服务器上执行移动，并把玩家位移的信息同步给所有客户端
&lt;ul>
&lt;li>信息同样包含：当前位置、目标位置、速度等&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>其他客户端收到了移动的信息后，修改角色的移动目标，根据插值调整角色位置&lt;/li>
&lt;/ul>
&lt;h3 id="引擎实现">&lt;a href="#%e5%bc%95%e6%93%8e%e5%ae%9e%e7%8e%b0" class="header-anchor">&lt;/a>引擎实现
&lt;/h3>&lt;p>虚幻引擎网络同步情况下的移动流程与此类似，大概为：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>每一帧执行TickComponent时，计算这一帧的加速度和转向，之后对于主控的Character，调用ReplicateMoveToServer把移动同步给服务器&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ReplicateMoveToServer会把移动保存到列表，然后执行PerformMovement在本地预执行移动操作。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>然后会调用ServerMove把移动同步给服务器，告知移动的参数、客户端自己移动的位置，以及时间戳&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ServerMove在服务器上执行，根据客户端声明的位置，与服务器的位置做对比，如果差异过大，则调用ClientAdjustPosition在主控端校正位置&lt;/p>
&lt;/li>
&lt;li>
&lt;p>客户端如果收到ClientAdjustPosition，会把客户端角色位置设置为服务器上的位置，并把bUpdatePosition标记为true，这将会影响到后续的移动更新&lt;/p>
&lt;/li>
&lt;li>
&lt;p>当客户端再次调用TickComponent时，如果存在bUpdatePosition，则会调用ClientUpdatePositionAfterServerUpdate来重演在服务器上调整移动之后发生的所有移动。&lt;/p>
&lt;blockquote>
&lt;p>在引擎源码CharacterMovementComponent.h中可以找到对移动同步流程的描述：&lt;/p>
&lt;p>Here&amp;rsquo;s how player movement prediction, replication and correction works in network games:&lt;/p>
&lt;p>Every tick, the TickComponent() function is called. It figures out the acceleration and rotation change for the frame,
and then calls PerformMovement() (for locally controlled Characters), or ReplicateMoveToServer() (if it&amp;rsquo;s a network client).&lt;/p>
&lt;p>ReplicateMoveToServer() saves the move (in the PendingMove list), calls PerformMovement(), and then replicates the move
to the server by calling the replicated function ServerMove() - passing the movement parameters, the client&amp;rsquo;s
resultant position, and a timestamp.&lt;/p>
&lt;p>ServerMove() is executed on the server. It decodes the movement parameters and causes the appropriate movement
to occur. It then looks at the resulting position and if enough time has passed since the last response, or the
position error is significant enough, the server calls ClientAdjustPosition(), a replicated function.&lt;/p>
&lt;p>ClientAdjustPosition() is executed on the client. The client sets its position to the servers version of position,
and sets the bUpdatePosition flag to true.&lt;/p>
&lt;p>When TickComponent() is called on the client again, if bUpdatePosition is true, the client will call
ClientUpdatePosition() before calling PerformMovement(). ClientUpdatePosition() replays all the moves in the pending
move list which occurred after the timestamp of the move the server was adjusting.&lt;/p>&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;h3 id="玩家输入">&lt;a href="#%e7%8e%a9%e5%ae%b6%e8%be%93%e5%85%a5" class="header-anchor">&lt;/a>玩家输入
&lt;/h3>&lt;p>管理玩家输入的也是一个组件&lt;code>UInputComponent&lt;/code>，通常可以调用&lt;code>BindAxis&lt;/code>来注册事件响应。&lt;/p>
&lt;p>一般最终会调用到&lt;code>UPawnMovementComponent::AddInputVector&lt;/code>来处理移动。&lt;/p>
&lt;h3 id="主控角色移动">&lt;a href="#%e4%b8%bb%e6%8e%a7%e8%a7%92%e8%89%b2%e7%a7%bb%e5%8a%a8" class="header-anchor">&lt;/a>主控角色移动
&lt;/h3>&lt;p>在UE的网络框架中，角色主要分为三种：ROLE_Authority、ROLE_AutonomousProxy、ROLE_SimulatedProxy。&lt;/p>
&lt;blockquote>
&lt;p>详见：&lt;a class="link" href="https://boiltask.com/ue/network-role/" >虚幻引擎中网络角色Role相关概念&lt;/a>&lt;/p>&lt;/blockquote>
&lt;p>在客户端主控角色也即Autonomous角色会接受控制，然后把移动数据发往服务器。&lt;/p>
&lt;p>本地的每次移动都会生成FSavedMove_Character，并维护一个&lt;code>TArray&amp;lt;FSavedMovePtr&amp;gt; SavedMoves&lt;/code>的数组，保存了当前玩家本地已经做的移动，这些移动还没经过服务器检查。&lt;/p>
&lt;p>如果服务器认可了一些移动，就可以把这些移动删掉，如果检查不通过，就可以据此执行异常处理。&lt;/p>
&lt;h3 id="协议选择">&lt;a href="#%e5%8d%8f%e8%ae%ae%e9%80%89%e6%8b%a9" class="header-anchor">&lt;/a>协议选择
&lt;/h3>&lt;p>在UE中，默认使用UDP作为传输协议，这可以使得数据包尽快送达。&lt;/p>
&lt;p>UDP不保证可达和有序，但是应用层面可以通过设计来在需要的地方避免这些问题。&lt;/p>
&lt;h2 id="server同步移动给客户端">&lt;a href="#server%e5%90%8c%e6%ad%a5%e7%a7%bb%e5%8a%a8%e7%bb%99%e5%ae%a2%e6%88%b7%e7%ab%af" class="header-anchor">&lt;/a>Server同步移动给客户端
&lt;/h2>&lt;h3 id="actor基本同步方案">&lt;a href="#actor%e5%9f%ba%e6%9c%ac%e5%90%8c%e6%ad%a5%e6%96%b9%e6%a1%88" class="header-anchor">&lt;/a>Actor基本同步方案
&lt;/h3>&lt;p>Actor自身就支持移动同步，打开ReplicateMovement开关后，当Actor的RootComponent位置、朝向等数据发生变化时，就会把数据同步给Simulate客户端。&lt;/p>
&lt;p>当Simulate的客户端收到同步之后，会简单的设置自己的位置和朝向。移动数据的同步有间隔，因此这种实现会导致Actor发生闪现。&lt;/p>
&lt;h3 id="character移动同步">&lt;a href="#character%e7%a7%bb%e5%8a%a8%e5%90%8c%e6%ad%a5" class="header-anchor">&lt;/a>Character移动同步
&lt;/h3>&lt;p>针对Actor基本同步模式的不足，CharacterMovementComponent针对性的做了表现平滑处理，让Simulate角色移动尽可能平滑自然。&lt;/p>
&lt;p>Character主要有两个组件，Capsule和Mesh，Capsule是Chara&lt;/p>
&lt;h2 id="关键概念">&lt;a href="#%e5%85%b3%e9%94%ae%e6%a6%82%e5%bf%b5" class="header-anchor">&lt;/a>关键概念
&lt;/h2>&lt;h3 id="ucharactermovement">&lt;a href="#ucharactermovement" class="header-anchor">&lt;/a>UCharacterMovement
&lt;/h3>&lt;p>角色移动组件是最为复杂的一个子类，需要重点进行分析。&lt;/p>
&lt;pre class="mermaid">
classDiagram
class UCharacterMovementComponent {
+IRVOAvoidanceInterface
+INetworkPredictionInterface
}
UActorComponent &amp;lt;|-- UMovementComponent
UMovementComponent &amp;lt;|-- UNavMovementComponent
UNavMovementComponent &amp;lt;|-- UPawnMovementComponent
UPawnMovementComponent &amp;lt;|-- UCharacterMovementComponent
&lt;/pre>
&lt;h3 id="fsavedmove_character">&lt;a href="#fsavedmove_character" class="header-anchor">&lt;/a>FSavedMove_Character
&lt;/h3>&lt;p>用于描述玩家的一次移动，可以认为是一次移动的快照。&lt;/p>
&lt;p>主要属性有：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>属性&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>TimeStamp&lt;/td>
&lt;td>这次移动发生的时间&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>DeltaTime&lt;/td>
&lt;td>这次移动使用的时间&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CustomTimeDilation&lt;/td>
&lt;td>时间膨胀系数，可以用于快进和慢放&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>StartPackedMovementMode&lt;/td>
&lt;td>移动发生前的MovementMode&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>StartLocation&lt;/td>
&lt;td>移动发生前的位置&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>StartVelocity&lt;/td>
&lt;td>移动发生前的速度&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>EndPackedMovementMode&lt;/td>
&lt;td>移动发生后的MovementMode&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SavedLocation&lt;/td>
&lt;td>移动发生后的位置&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SavedVelocity&lt;/td>
&lt;td>移动发生后的速度&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Acceleration&lt;/td>
&lt;td>移动所用加速度&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>理论上只要有这些数据，就能复盘整个移动过程，也可用作回放功能。&lt;/p>
&lt;h3 id="replicatemovetoserver">&lt;a href="#replicatemovetoserver" class="header-anchor">&lt;/a>ReplicateMoveToServer
&lt;/h3>&lt;p>首先会从SavedMoves里找到最早发生的一个ImportantMove（通过IsImportantMove判断），也就是最新被服务器确认的有显著差异的Move。&lt;/p>
&lt;p>之后创建一个FSavedMove_Character并初始化。然后执行PerformMovement，对角色计算操作后的属性，设置上相关信息。&lt;/p>
&lt;p>根据能否被合并，进行处理。&lt;/p>
&lt;h3 id="延迟发送move">&lt;a href="#%e5%bb%b6%e8%bf%9f%e5%8f%91%e9%80%81move" class="header-anchor">&lt;/a>延迟发送Move
&lt;/h3>&lt;p>一个Move有可能可以被延迟一会，与后面的Move合并后再发给服务器。因此一个新建的Move被发往服务器前会先判断是否可以延迟发送。&lt;/p>
&lt;p>首先判断是否开启了NetEnableMoveCombining，如果没开也不会延迟发送。&lt;/p>
&lt;p>同时还会判断当前的Move是否能被延迟发送，会检查该Move前后MovementMode是否改变，如果改变也需要即使变化。也就是说，如果此次Move没有显著改变，那么则可以延后发送，理论上服务器根据之前的信息推算，结果应该是一样的。&lt;/p>
&lt;p>然后会计算当前预期的移动更新时间间隔，根据当前网速、玩家数量等信息，在基准值ClientNetSendMoveDeltaTime上做调整，得到最终间隔，如果Tick时还没达到更新间隔，就会延迟发送Move，把它储存在PendingMove中，留着以后处理。&lt;/p>
&lt;h3 id="callservermove">&lt;a href="#callservermove" class="header-anchor">&lt;/a>CallServerMove
&lt;/h3>&lt;p>函数接受两个参数，一个是刚创建的Move，另一个是之前获取的ImportantMove（ImportantMove可能为空）。不需要把整个Move都发往服务器，只需要位置、旋转、加速度等关键信息，并且这些信息会经过压缩。&lt;/p>
&lt;p>压缩的过程简单来说，会尝试牺牲精度，把一些字段合并在一个数据结构中。&lt;/p>
&lt;p>之后还会调用ServerMoveOld，把ImportantMove中的一些信息发送到服务器，可以简单理解为一种冗余的保险。&lt;/p>
&lt;p>如果存在PendingMove，说明存在未合并的Move，需要调用ServerMoveDual一次发送两个连续的Move。否则，说明发送间隔较大，或者PendingMove已经被合并，就调用ServerMode发送这个Move。&lt;/p>
&lt;h3 id="servermoveold">&lt;a href="#servermoveold" class="header-anchor">&lt;/a>ServerMoveOld
&lt;/h3>&lt;p>ServerMoveOld主要作为一种冗余措施，防止服务器新收到一个移动数据时，因为网络丢包而落后太多，导致移动判断不通过，进而纠正客户端位置。ServerMoveOld可以让服务器使用传递的加速度，粗略的从旧位置快速移动到新位置，不校验移动结果。&lt;/p>
&lt;blockquote>
&lt;p>TODO：安全性如何保证？&lt;/p>&lt;/blockquote>
&lt;h2 id="todo">&lt;a href="#todo" class="header-anchor">&lt;/a>TODO
&lt;/h2>&lt;ul>
&lt;li>
&lt;p>具有物理模拟下的移动&lt;/p>
&lt;/li>
&lt;li>
&lt;p>移动如何通过RPC发送的&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="参考文章">&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0" class="header-anchor">&lt;/a>参考文章
&lt;/h2>&lt;ul>
&lt;li>&lt;a class="link" href="https://zhuanlan.zhihu.com/p/114341957" target="_blank" rel="noopener"
>UE4移动的网络同步 - 知乎&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://zhuanlan.zhihu.com/p/664568047" target="_blank" rel="noopener"
>UE4/UE5 Character Movement Component移动组件网络同步详解 - 知乎&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://zhuanlan.zhihu.com/p/650314172" target="_blank" rel="noopener"
>「Grow by UE」图解角色移动组件 - 知乎&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://zhuanlan.zhihu.com/p/20098342802" target="_blank" rel="noopener"
>UE移动同步原理分析（一）：Pawn的移动属性复制 - 知乎&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>UnrealEngine虚幻引擎编译选项</title><link>https://boiltask.com/knowledge/ue/build-configuration/</link><pubDate>Wed, 05 Mar 2025 12:42:21 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/build-configuration/</guid><description>&lt;h2 id="配置参数">&lt;a href="#%e9%85%8d%e7%bd%ae%e5%8f%82%e6%95%b0" class="header-anchor">&lt;/a>配置参数
&lt;/h2>&lt;h3 id="window指定编译sdk">&lt;a href="#window%e6%8c%87%e5%ae%9a%e7%bc%96%e8%af%91sdk" class="header-anchor">&lt;/a>Window指定编译SDK
&lt;/h3>&lt;p>修改&lt;code>Engine/Saved/UnrealBuildTool/BuildConfiguration.xml&lt;/code>中的配置，添加&lt;code>MSVC&lt;/code>版本号、&lt;code>SDK&lt;/code>的版本号。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;WindowsPlatform&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;CompilerVersion&lt;/span> &lt;span class="nt">&amp;gt;&lt;/span>14.40.33807&lt;span class="nt">&amp;lt;/CompilerVersion&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;WindowsSdkVersion&amp;gt;&lt;/span>10.0.20348.0&lt;span class="nt">&amp;lt;/WindowsSdkVersion&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/WindowsPlatform&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="最终示例">&lt;a href="#%e6%9c%80%e7%bb%88%e7%a4%ba%e4%be%8b" class="header-anchor">&lt;/a>最终示例
&lt;/h2>&lt;p>配置文件形如：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;utf-8&amp;#34; ?&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Configuration&lt;/span> &lt;span class="na">xmlns=&lt;/span>&lt;span class="s">&amp;#34;https://www.unrealengine.com/BuildConfiguration&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;WindowsPlatform&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;WindowsSdkVersion&amp;gt;&lt;/span>10.0.19041.0&lt;span class="nt">&amp;lt;/WindowsSdkVersion&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/WindowsPlatform&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Configuration&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="参考文章">&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0" class="header-anchor">&lt;/a>参考文章
&lt;/h2>&lt;p>&lt;a class="link" href="https://dev.epicgames.com/documentation/en-us/unreal-engine/build-configuration-for-unreal-engine" target="_blank" rel="noopener"
>Build Configuration for Unreal Engine | Unreal Engine 5.5 Documentation | Epic Developer Community&lt;/a>&lt;/p></description></item><item><title>UE4常用控制台指令</title><link>https://boiltask.com/knowledge/ue/common-console-command/</link><pubDate>Wed, 26 Feb 2025 11:44:41 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/common-console-command/</guid><description>&lt;p>在编辑器中按下~键打开控制台（就是数字1左边的那个按键）&lt;/p>
&lt;p>下面列出一些常用的控制台指令：&lt;/p>
&lt;p>stat fps 显示帧率&lt;/p>
&lt;p>stat unit 显示包括drawcall，游戏逻辑线程，渲染线程，面数等信息（面数信息需要在设置中调整ES3.1才会显示）&lt;/p>
&lt;p>slomo 0.1 游戏运行下的速度0.1表示运行速度变为正常的十分之一&lt;/p>
&lt;p>r.showcollision 显示碰撞体&lt;/p>
&lt;p>t.maxfps 60 设置最大帧率&lt;/p>
&lt;p>更多控制台指令可以在下面这个网站查询： &lt;a class="link" href="https://digilander.libero.it/ZioYuri78/" target="_blank" rel="noopener"
>https://digilander.libero.it/ZioYuri78/&lt;/a>&lt;/p></description></item><item><title>虚幻引擎蓝图合并工具</title><link>https://boiltask.com/knowledge/ue/blueprint-merge/</link><pubDate>Mon, 24 Feb 2025 11:57:11 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/blueprint-merge/</guid><description>&lt;p>UE对于Blueprint似乎有个函数级的Merge工具，初体验不太好用还在研究。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C++" data-lang="C++">&lt;span class="line">&lt;span class="cl">&lt;span class="nl">D&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">MetaEngine&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">Engine&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">Binaries&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">Win64&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">UE4Editor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">exe&lt;/span> &lt;span class="nl">D&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">Meta&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">Meta&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">uproject&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">diff&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="n">theirs&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="n">mine&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="n">base&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="n">merged&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://boiltask.com/knowledge/ue/blueprint-merge/image.png"
width="1920"
height="1040"
srcset="https://boiltask.com/knowledge/ue/blueprint-merge/image_hu_e3113eff777536f7.png 480w, https://boiltask.com/knowledge/ue/blueprint-merge/image_hu_798e2fc5c72c06e8.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="184"
data-flex-basis="443px"
>&lt;/p></description></item><item><title>虚幻引擎中Actor复制流程</title><link>https://boiltask.com/knowledge/ue/actor-replication/</link><pubDate>Mon, 02 Dec 2024 22:17:16 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/actor-replication/</guid><description>&lt;blockquote>
&lt;p>&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/detailed-actor-replication-flow-in-unreal-engine" target="_blank" rel="noopener"
>Detailed Actor Replication Flow&lt;/a>暂时没有官方翻译，尝试理解顺便翻译一下。&lt;/p>&lt;/blockquote>
&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>&lt;strong>Actor复制&lt;/strong>是一个详细的多步骤过程，其中&lt;strong>网络驱动程序&lt;/strong>（Net Driver）确定需要向哪些连接复制哪些Actor，以及按照什么顺序复制。本页面提供了Actor复制流程的概述。&lt;/p>
&lt;p>大多数Actor的复制是在&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/API/Runtime/Engine/Engine/UNetDriver/ServerReplicateActors" target="_blank" rel="noopener"
>&lt;code>UNetDriver::ServerReplicateActors&lt;/code>&lt;/a>函数中进行的。 在这个函数中，服务器会首先收集所有被判定对每个客户端相关的Actor，然后将自上次更新以来发生变化的属性发送给每个已连接的客户端。随后，&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/API/Runtime/Engine/Engine/UActorChannel/ReplicateActor" target="_blank" rel="noopener"
>&lt;code>UActorChannel::ReplicateActor&lt;/code>&lt;/a> 函数负责处理将特定Actor复制到某一通道的详细操作。&lt;/p>
&lt;h2 id="重要属性">&lt;a href="#%e9%87%8d%e8%a6%81%e5%b1%9e%e6%80%a7" class="header-anchor">&lt;/a>重要属性
&lt;/h2>&lt;p>对于如何更新 actor、调用某些框架回调以及用于确定在当前服务器 tick 期间是否复制 actor 的属性，有一个定义的流程。以下是一些重要的属性：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>属性&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>AActor::NetUpdateFrequency&lt;/code>&lt;/td>
&lt;td>决定Actor复制的频率。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>AActor::PreReplication&lt;/code>&lt;/td>
&lt;td>在任何复制操作发生之前调用。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>AActor::bOnlyRelevantToOwner&lt;/code>&lt;/td>
&lt;td>如果该Actor只会复制给其拥有者，则为&lt;code>True&lt;/code>。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>AActor::IsRelevancyOwnerFor&lt;/code>&lt;/td>
&lt;td>当&lt;code>bOnlyRelevantToOwner&lt;/code>为&lt;code>True&lt;/code>时，决定Actor的相关性。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>AActor::IsNetRelevantFor&lt;/code>&lt;/td>
&lt;td>当&lt;code>bOnlyRelevantToOwner&lt;/code>为&lt;code>False&lt;/code>时，决定Actor的相关性。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>AActor::NetDormancy&lt;/code>&lt;/td>
&lt;td>决定Actor是处于休眠状态还是激活状态。&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="actor复制流程概述">&lt;a href="#actor%e5%a4%8d%e5%88%b6%e6%b5%81%e7%a8%8b%e6%a6%82%e8%bf%b0" class="header-anchor">&lt;/a>Actor复制流程概述
&lt;/h2>&lt;p>以下步骤构成了Actor复制过程的高级概述：&lt;/p>
&lt;ol>
&lt;li>确定需要复制的Actors，并进行检查以确定它们的休眠状态、更新频率以及拥有的连接。&lt;/li>
&lt;li>将通过这些检查的Actors添加到一个列表中，准备进行复制。&lt;/li>
&lt;li>遍历每个连接，并根据当前的Actor和连接执行检查。完成此步骤后，得到每个连接需要复制的Actor列表。&lt;/li>
&lt;li>按照优先级对每个连接的Actors进行排序。&lt;/li>
&lt;li>确定该Actor是否对当前连接相关。&lt;/li>
&lt;li>将该Actor复制到当前连接。&lt;/li>
&lt;/ol>
&lt;p>以下部分将提供上述Actor复制流程概述中每一步的详细描述。&lt;/p>
&lt;hr>
&lt;h3 id="将actor添加到待复制列表">&lt;a href="#%e5%b0%86actor%e6%b7%bb%e5%8a%a0%e5%88%b0%e5%be%85%e5%a4%8d%e5%88%b6%e5%88%97%e8%a1%a8" class="header-anchor">&lt;/a>将Actor添加到待复制列表
&lt;/h3>&lt;p>此步骤首先检查所有Actors，确定哪些Actors正在进行复制（通过检查是否调用了 &lt;code>AActor::SetReplicates(true)&lt;/code>）。对于每个正在复制的Actor，&lt;code>NetDriver&lt;/code> 执行以下检查：&lt;/p>
&lt;ul>
&lt;li>判断当前Actor是否初始处于休眠状态（&lt;code>ENetDormancy::DORM_Initial&lt;/code>）。
&lt;ul>
&lt;li>如果是休眠状态，则跳过该Actor。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>检查当前Actor是否需要更新，具体通过检查 &lt;code>AActor::NetUpdateFrequency&lt;/code> 属性。
&lt;ul>
&lt;li>如果不需要更新，则跳过该Actor。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>如果 &lt;code>AActor::bOnlyRelevantToOwner&lt;/code> 为 &lt;code>true&lt;/code>，则检查该Actor的拥有连接的相关性，通过调用 &lt;code>AActor::IsRelevancyOwnerFor&lt;/code> 来判断。
&lt;ul>
&lt;li>如果相关，则将其添加到该连接的“拥有者相关列表”中。&lt;/li>
&lt;li>在这种情况下，该Actor只会发送给单个连接。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>对于通过上述检查的每个Actor，调用 &lt;code>AActor::PreReplication&lt;/code>。在 &lt;code>AActor::PreReplication&lt;/code> 中，你可以决定是否希望某些属性仅复制到特定连接。可以使用 &lt;code>DOREPLIFETIME_ACTIVE_OVERRIDE&lt;/code> 宏来控制Actor复制到哪些连接。&lt;/li>
&lt;/ul>
&lt;p>如果Actor通过了所有检查，将其添加到待复制列表中。&lt;/p>
&lt;hr>
&lt;h3 id="遍历每个连接">&lt;a href="#%e9%81%8d%e5%8e%86%e6%af%8f%e4%b8%aa%e8%bf%9e%e6%8e%a5" class="header-anchor">&lt;/a>遍历每个连接
&lt;/h3>&lt;p>接下来，系统遍历每个连接，并为从前一步骤中获得的待复制Actor列表中的每个Actor执行以下检查和操作：&lt;/p>
&lt;ul>
&lt;li>判断当前Actor是否处于休眠状态，通过调用 &lt;code>AActor::NetDormancy&lt;/code>。
&lt;ul>
&lt;li>如果该Actor在此连接下处于休眠状态，则跳过该Actor。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>如果尚未打开通道：
&lt;ul>
&lt;li>判断客户端是否已加载当前Actor所在的关卡。&lt;/li>
&lt;li>如果该关卡尚未加载，则跳过该Actor。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>判断当前Actor是否与该连接相关，通过调用 &lt;code>AActor::IsNetRelevantFor&lt;/code>。
&lt;ul>
&lt;li>如果Actor与连接不相关，则跳过该Actor。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>将所有在连接的“拥有者相关列表”中的Actors添加到此列表中。此时，列表中包含了所有与该连接相关且不处于休眠状态的Actors。然后按照优先级（&lt;code>AActor::GetNetPriority&lt;/code>）对这些Actors进行排序，优先级从高到低排序。排序至关重要，尤其是当考虑复制大量Actor时，需要确保优先复制高优先级的Actor。&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="遍历排序后的actor列表">&lt;a href="#%e9%81%8d%e5%8e%86%e6%8e%92%e5%ba%8f%e5%90%8e%e7%9a%84actor%e5%88%97%e8%a1%a8" class="header-anchor">&lt;/a>遍历排序后的Actor列表
&lt;/h3>&lt;p>对于该连接的每个Actor，在排序后的待复制列表中执行以下操作：&lt;/p>
&lt;ul>
&lt;li>如果连接尚未加载该Actor所在的关卡，则关闭通道（如果存在）并继续。&lt;/li>
&lt;li>每秒检查一次Actor是否与连接相关，调用 &lt;code>AActor::IsNetRelevantFor&lt;/code>。
&lt;ul>
&lt;li>如果在5秒内不相关，则关闭通道。&lt;/li>
&lt;li>如果相关且没有通道打开，则打开通道。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>如果此连接在任何时刻变得饱和：
&lt;ul>
&lt;li>对于剩余的Actors：
&lt;ul>
&lt;li>如果相关时间少于1秒，则强制在下一tick更新。&lt;/li>
&lt;li>如果相关时间超过1秒，调用 &lt;code>AActor::IsNetRelevantFor&lt;/code> 判断是否在下一tick更新。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>对于通过所有检查的Actor，通过调用 &lt;code>UActorChannel::ReplicateActor&lt;/code> 将Actor复制到连接。&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="控制每次调用时复制的客户端数">&lt;a href="#%e6%8e%a7%e5%88%b6%e6%af%8f%e6%ac%a1%e8%b0%83%e7%94%a8%e6%97%b6%e5%a4%8d%e5%88%b6%e7%9a%84%e5%ae%a2%e6%88%b7%e7%ab%af%e6%95%b0" class="header-anchor">&lt;/a>控制每次调用时复制的客户端数
&lt;/h3>&lt;p>你可以通过以下几种方式控制 &lt;code>UNetDriver::ServerReplicateActors&lt;/code> 每次调用时复制的客户端数：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>引擎配置和命令行参数：&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>启动项目时使用 &lt;code>-limitclientticks&lt;/code> 命令行参数。&lt;/li>
&lt;li>修改引擎配置中的 &lt;code>NetClientTicksPerSecond&lt;/code> 值（位于 &lt;code>[/Script/Engine.Engine]&lt;/code> 类别）。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>命令行参数：&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>启动项目时使用命令行参数：&lt;code>-limitclientticks -ini:Engine:[/Script/Engine.Engine]:NetClientTicksPerSecond=&amp;lt;VALUE&amp;gt;&lt;/code>，其中 &lt;code>&amp;lt;VALUE&amp;gt;&lt;/code> 是每秒希望使用的客户端ticks数。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>控制台变量：&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>设置 &lt;code>net.MaxConnectionsToTickPerServerFrame&lt;/code> 控制台变量。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>更多信息请参考 &lt;code>UNetDriver::ServerReplicateActors_PrepConnections&lt;/code>。&lt;/p>
&lt;hr>
&lt;h3 id="将actor复制到连接">&lt;a href="#%e5%b0%86actor%e5%a4%8d%e5%88%b6%e5%88%b0%e8%bf%9e%e6%8e%a5" class="header-anchor">&lt;/a>将Actor复制到连接
&lt;/h3>&lt;p>&lt;code>UActorChannel::ReplicateActor&lt;/code> 是复制Actor及其所有组件到连接的主要方法。其流程如下：&lt;/p>
&lt;ul>
&lt;li>判断这是Actor通道打开后的第一次更新。
&lt;ul>
&lt;li>如果是第一次更新，则序列化需要的信息（初始位置、旋转等）。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>判断当前连接是否拥有该Actor。
&lt;ul>
&lt;li>如果没有拥有该Actor，且该Actor的角色为 &lt;code>ENetRole::ROLE_AutonomousProxy&lt;/code>，则降级为 &lt;code>ENetRole::ROLE_SimulatedProxy&lt;/code>。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>复制该Actor已更改的属性。&lt;/li>
&lt;li>复制每个组件已更改的属性。&lt;/li>
&lt;li>对于任何已删除的组件，发送特殊的删除命令。&lt;/li>
&lt;li>一旦Actor列表已处理完，或通道已饱和，开始考虑下一个连接，并重复该过程直到所有连接都已更新。&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="更多信息">&lt;a href="#%e6%9b%b4%e5%a4%9a%e4%bf%a1%e6%81%af" class="header-anchor">&lt;/a>更多信息
&lt;/h3>&lt;p>有关Actor复制的更多信息，请参考以下头文件中的内容：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>/Engine/Source/Runtime/Engine/Classes/Engine/NetDriver.h&lt;/code>&lt;br>
关于 &lt;code>UNetDriver::ServerReplicateActors&lt;/code> 的信息。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>/Engine/Source/Runtime/Engine/Classes/GameFramework/Actor.h&lt;/code>&lt;br>
关于 &lt;code>AActor&lt;/code> 及其函数和属性的信息。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>/Engine/Source/Runtime/Engine/Classes/Engine/ActorChannel.h&lt;/code>&lt;br>
关于 &lt;code>UActorChannel&lt;/code> 和 &lt;code>UActorChannel::ReplicateActor&lt;/code> 的信息。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>/Engine/Source/Runtime/Engine/Classes/Engine/EngineTypes.h&lt;/code>&lt;br>
关于 &lt;code>ENetRole&lt;/code> 和 &lt;code>ENetDormancy&lt;/code> 等类型的信息。&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>虚幻引擎中网络相关机制</title><link>https://boiltask.com/knowledge/ue/network-start/</link><pubDate>Mon, 02 Dec 2024 13:13:25 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/network-start/</guid><description>&lt;h2 id="简介">&lt;a href="#%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>简介
&lt;/h2>&lt;p>想到哪里写到哪里吧，后续有可能再补充。&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://boiltask.com/ue/actor-replication/" >虚幻引擎中Actor复制流程&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://boiltask.com/ue/network-role/" >虚幻引擎中网络角色Role相关概念&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>虚幻引擎中编辑器下Python的使用</title><link>https://boiltask.com/knowledge/ue/editor-python/</link><pubDate>Mon, 02 Dec 2024 12:57:53 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/editor-python/</guid><description>&lt;h2 id="功能简介">&lt;a href="#%e5%8a%9f%e8%83%bd%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>功能简介
&lt;/h2>&lt;p>参考文档：&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/scripting-the-unreal-editor-using-python" target="_blank" rel="noopener"
>使用Python脚本化运行虚幻编辑器&lt;/a>&lt;/p></description></item><item><title>虚幻引擎中DataAsset的使用</title><link>https://boiltask.com/knowledge/ue/data-asset/</link><pubDate>Thu, 28 Nov 2024 13:14:08 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/data-asset/</guid><description>&lt;h2 id="dataasset简介">&lt;a href="#dataasset%e7%ae%80%e4%bb%8b" class="header-anchor">&lt;/a>DataAsset简介
&lt;/h2>&lt;p>一般用于表示一个数据块，功能与DataTable类似，某种程度上可以理解成一个仅有一行的DataTable。&lt;/p>
&lt;p>参考文档：&lt;a class="link" href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/data-assets-in-unreal-engine" target="_blank" rel="noopener"
>数据资产&lt;/a>&lt;/p></description></item><item><title>Lyra的默认场景中关卡选择器的创建</title><link>https://boiltask.com/knowledge/ue/lyra-start-map/</link><pubDate>Thu, 28 Nov 2024 13:04:08 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/lyra-start-map/</guid><description>&lt;p>打开Lyra的默认场景，运行后发现其生成了几个关卡选择器，研究一下生成原理。&lt;/p></description></item><item><title>虚幻引擎中下载Lyra官方示例项目</title><link>https://boiltask.com/knowledge/ue/lyra-download/</link><pubDate>Wed, 27 Nov 2024 12:54:43 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/lyra-download/</guid><description>&lt;p>最近想要细研究一下&lt;code>UE5&lt;/code>的官方示例项目&lt;code>Lyra&lt;/code>，因此创建了一些相关的博文来记录一下研究过程中的所想，总结一下项目所涉及到的技术点。&lt;/p>
&lt;p>时间点开始于2024年11月，没有提到的话相关项目以此时间点的最新版本为准。&lt;/p>
&lt;p>Lyra的项目目前可以在Fab中找到：&lt;a class="link" href="https://www.fab.com/zh-cn/listings/93faede1-4434-47c0-85f1-bf27c0820ad0" target="_blank" rel="noopener"
>https://www.fab.com/zh-cn/listings/93faede1-4434-47c0-85f1-bf27c0820ad0&lt;/a>&lt;/p>
&lt;p>在虚幻引擎启动器&lt;code>Epic Games Launcher&lt;/code>中，可以在库找到&lt;code>Lyra&lt;/code>项目，创建项目即可。&lt;/p>
&lt;p>经过测试，虽然更新日志标注了支持UE5.5，不过目前创建的仍然是UE5.1版本，后续先使用UE5.1版本测试。&lt;/p></description></item><item><title>查找Module被谁引入</title><link>https://boiltask.com/knowledge/ue/find-module-reference/</link><pubDate>Wed, 02 Aug 2023 12:13:26 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/find-module-reference/</guid><description>&lt;p>想知道一个Module被谁引入的，可以通过让其报错来查看堆栈。&lt;/p>
&lt;p>在模块的&lt;code>Build.cs&lt;/code>中第一行加入：&lt;code>throw new Exception()&lt;/code>。&lt;/p>
&lt;p>编译，查看报错即可。&lt;/p></description></item><item><title>引擎内置版本控制工具</title><link>https://boiltask.com/knowledge/ue/source-control-tool/</link><pubDate>Mon, 13 Mar 2023 19:33:24 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/source-control-tool/</guid><description>&lt;h2 id="功能简述">&lt;a href="#%e5%8a%9f%e8%83%bd%e7%ae%80%e8%bf%b0" class="header-anchor">&lt;/a>功能简述
&lt;/h2>&lt;p>为了便于多人协作&lt;code>UnrealEngine&lt;/code>提供了一个版本控制工具，可结合&lt;code>SVN&lt;/code>、&lt;code>Git&lt;/code>等工具对蓝图等资产进行版本控制。&lt;/p>
&lt;h2 id="工具使用">&lt;a href="#%e5%b7%a5%e5%85%b7%e4%bd%bf%e7%94%a8" class="header-anchor">&lt;/a>工具使用
&lt;/h2>&lt;h3 id="配置连接">&lt;a href="#%e9%85%8d%e7%bd%ae%e8%bf%9e%e6%8e%a5" class="header-anchor">&lt;/a>配置连接
&lt;/h3>&lt;p>在引擎的工具栏处有一个&lt;code>Source Control&lt;/code>的选项，选择&lt;code>Connect to Source Control&lt;/code>弹出确认框。
&lt;img src="https://boiltask.com/knowledge/ue/source-control-tool/image-1.png"
width="433"
height="290"
srcset="https://boiltask.com/knowledge/ue/source-control-tool/image-1_hu_253a9c52273077de.png 480w, https://boiltask.com/knowledge/ue/source-control-tool/image-1_hu_efe1e3fd85fc70fd.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="149"
data-flex-basis="358px"
>&lt;/p>
&lt;p>选择&lt;code>Subversion&lt;/code>也即&lt;code>SVN&lt;/code>，展示信息输入框。&lt;/p>
&lt;p>&lt;img src="https://boiltask.com/knowledge/ue/source-control-tool/image-2.png"
width="720"
height="267"
srcset="https://boiltask.com/knowledge/ue/source-control-tool/image-2_hu_7d92eaeeade92e1.png 480w, https://boiltask.com/knowledge/ue/source-control-tool/image-2_hu_309f8ecf4fff2e37.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="269"
data-flex-basis="647px"
>&lt;/p>
&lt;p>按照所需信息输入然后点击&lt;code>Accept Settings&lt;/code>即可。
&lt;img src="https://boiltask.com/knowledge/ue/source-control-tool/image-3.png"
width="720"
height="274"
srcset="https://boiltask.com/knowledge/ue/source-control-tool/image-3_hu_c2fdbd4b8ea3c3b.png 480w, https://boiltask.com/knowledge/ue/source-control-tool/image-3_hu_62fc1eca1dad230.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="262"
data-flex-basis="630px"
>&lt;/p>
&lt;p>其中几项含义分别如下：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>字段&lt;/th>
&lt;th>说明&lt;/th>
&lt;th>示例&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Provider&lt;/td>
&lt;td>使用的版本控制系统&lt;/td>
&lt;td>Subversion&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Repository&lt;/td>
&lt;td>仓库的链接&lt;/td>
&lt;td>http://&lt;em>&lt;strong>.&lt;/strong>&lt;/em>.com/svn/***/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>User Name&lt;/td>
&lt;td>用户名&lt;/td>
&lt;td>***&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Labels Directory&lt;/td>
&lt;td>仓库子路径，比如主干、某一分支等&lt;/td>
&lt;td>trunk&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Password&lt;/td>
&lt;td>用户密码&lt;/td>
&lt;td>abcdefg123465&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="资产保存">&lt;a href="#%e8%b5%84%e4%ba%a7%e4%bf%9d%e5%ad%98" class="header-anchor">&lt;/a>资产保存
&lt;/h3>&lt;p>链接版本管理后，对资产做保存等操作时会弹出确认框，询问是否要&lt;code>CheckOut&lt;/code>。&lt;/p>
&lt;p>此操作对应&lt;code>SVN&lt;/code>的&lt;a class="link" href="https://boiltask.com/knowledge/svn-lock" >SVN锁定操作&lt;/a>，修改前先锁定，这样避免了多人修改同一蓝图时的冲突。&lt;/p>
&lt;p>&lt;img src="https://boiltask.com/knowledge/ue/source-control-tool/image-4.png"
width="760"
height="434"
srcset="https://boiltask.com/knowledge/ue/source-control-tool/image-4_hu_49e988e335179047.png 480w, https://boiltask.com/knowledge/ue/source-control-tool/image-4_hu_b3863dacc44b5c9.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="175"
data-flex-basis="420px"
>&lt;/p>
&lt;p>如果该资产已经被其他人锁定了，那么点&lt;code>CheckOut&lt;/code>时会有如下提示。&lt;/p>
&lt;p>&lt;img src="https://boiltask.com/knowledge/ue/source-control-tool/image-5.png"
width="760"
height="434"
srcset="https://boiltask.com/knowledge/ue/source-control-tool/image-5_hu_e70716767cb0153e.png 480w, https://boiltask.com/knowledge/ue/source-control-tool/image-5_hu_5c24fc909773a367.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="175"
data-flex-basis="420px"
>&lt;/p>
&lt;p>如果大家都遵循此操作，则可以大大减少蓝图冲突的可能性。&lt;/p>
&lt;p>如果不需要锁定蓝图，那么可以点击&lt;code>Make Writable&lt;/code>在不锁定的情况下保存。&lt;/p>
&lt;h3 id="资产操作">&lt;a href="#%e8%b5%84%e4%ba%a7%e6%93%8d%e4%bd%9c" class="header-anchor">&lt;/a>资产操作
&lt;/h3>&lt;p>链接版本管理后，在资产上右键可以展开版本管理的操作。&lt;/p>
&lt;p>&lt;img src="https://boiltask.com/knowledge/ue/source-control-tool/image-6.png"
width="477"
height="748"
srcset="https://boiltask.com/knowledge/ue/source-control-tool/image-6_hu_5b8d9d97a149e5e2.png 480w, https://boiltask.com/knowledge/ue/source-control-tool/image-6_hu_a12daae2e9ccac54.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="63"
data-flex-basis="153px"
>&lt;/p>
&lt;p>其中几项含义分别如下：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>字段&lt;/th>
&lt;th>说明&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>CheckOut&lt;/td>
&lt;td>CheckOut资产，对应前文的锁定&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Refresh&lt;/td>
&lt;td>刷新资产版本状态，解决有时候更新不及时的问题&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>History&lt;/td>
&lt;td>打开资产的版本历史&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Diff Against Depot&lt;/td>
&lt;td>对比资产与仓库中的最新版本&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>其中最常用的是&lt;code>History&lt;/code>打开资产版本历史。&lt;/p>
&lt;p>&lt;img src="https://boiltask.com/knowledge/ue/source-control-tool/image-7.png"
width="1010"
height="434"
srcset="https://boiltask.com/knowledge/ue/source-control-tool/image-7_hu_224429b8fa71ab5d.png 480w, https://boiltask.com/knowledge/ue/source-control-tool/image-7_hu_f5af0be37f94f491.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="232"
data-flex-basis="558px"
>&lt;/p>
&lt;p>可以在版本历史里右键选择对比前一版本或对比本地文件。&lt;/p>
&lt;p>&lt;img src="https://boiltask.com/knowledge/ue/source-control-tool/image-8.png"
width="1010"
height="834"
srcset="https://boiltask.com/knowledge/ue/source-control-tool/image-8_hu_ea36e1c0f0281fdc.png 480w, https://boiltask.com/knowledge/ue/source-control-tool/image-8_hu_17e33c74c2dcf12.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="121"
data-flex-basis="290px"
>&lt;/p>
&lt;h2 id="注意事项">&lt;a href="#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9" class="header-anchor">&lt;/a>注意事项
&lt;/h2>&lt;p>在资产管理中&lt;code>CheckOut&lt;/code>操作对应&lt;code>SVN&lt;/code>的&lt;code>Lock&lt;/code>操作，会锁定资产防止别人提交，因此会干扰其他同事操作。&lt;/p>
&lt;p>&lt;a class="link" href="https://boiltask.com/knowledge/svn-lock" >SVN锁定操作&lt;/a>前需要确认操作的必要性，如果遇见有人询问相关问题，应积极处理。&lt;/p>
&lt;p>连接&lt;code>SVN&lt;/code>后，一些操作会自动对&lt;code>SVN&lt;/code>做标记，如移动路径、重命名、删除等，会增加操作时间，耐心等待即可。&lt;/p></description></item><item><title>虚幻引擎蓝图对比工具</title><link>https://boiltask.com/knowledge/ue/blueprint-diff/</link><pubDate>Mon, 13 Mar 2023 18:50:21 +0800</pubDate><guid>https://boiltask.com/knowledge/ue/blueprint-diff/</guid><description>&lt;h2 id="功能简述">&lt;a href="#%e5%8a%9f%e8%83%bd%e7%ae%80%e8%bf%b0" class="header-anchor">&lt;/a>功能简述
&lt;/h2>&lt;p>蓝图因为是二进制文件，所以没办法使用&lt;code>svn&lt;/code>自带的版本对比工具来比较变更。&lt;/p>
&lt;p>为了解决蓝图对比的问题，&lt;code>UE4&lt;/code>提供了一个工具用以展示两个蓝图的区别。&lt;/p>
&lt;p>可以在UE编辑器中可以直接连接版本控制工具，从而提供直接查看版本历史、启动对比工具、冲突提示等功能，配置细节可以查看：&lt;a class="link" href="https://boiltask.com/ue/source-control-tool" >引擎内置版本控制工具&lt;/a>&lt;/p>
&lt;p>本文描述的是如何从外部调用引擎的对比工具。&lt;/p>
&lt;h2 id="工具使用">&lt;a href="#%e5%b7%a5%e5%85%b7%e4%bd%bf%e7%94%a8" class="header-anchor">&lt;/a>工具使用
&lt;/h2>&lt;p>直接使用可以在&lt;code>cmd&lt;/code>命令提示符窗口输入如下命令：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-Bash" data-lang="Bash">&lt;span class="line">&lt;span class="cl">引擎路径&lt;span class="se">\E&lt;/span>ngine&lt;span class="se">\B&lt;/span>inaries&lt;span class="se">\W&lt;/span>in64&lt;span class="se">\U&lt;/span>E4Editor.exe 项目路径&lt;span class="se">\M&lt;/span>eta.uproject -diff 文件1路径 文件2路径&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>完整示例如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-Bash" data-lang="Bash">&lt;span class="line">&lt;span class="cl">D:&lt;span class="se">\M&lt;/span>etaEngine&lt;span class="se">\E&lt;/span>ngine&lt;span class="se">\B&lt;/span>inaries&lt;span class="se">\W&lt;/span>in64&lt;span class="se">\U&lt;/span>E4Editor.exe D:&lt;span class="se">\M&lt;/span>eta&lt;span class="se">\M&lt;/span>eta.uproject -diff D:&lt;span class="se">\M&lt;/span>eta&lt;span class="se">\C&lt;/span>ontent&lt;span class="se">\T&lt;/span>est1.uasset D:&lt;span class="se">\M&lt;/span>eta&lt;span class="se">\C&lt;/span>ontent&lt;span class="se">\T&lt;/span>est2.uasset&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>原理是运行引擎时传入&lt;code>-diff&lt;/code>参数开启对比窗口，同时传入所需的项目路径与文件路径。&lt;/p>
&lt;h2 id="结合svn">&lt;a href="#%e7%bb%93%e5%90%88svn" class="header-anchor">&lt;/a>结合SVN
&lt;/h2>&lt;p>结合&lt;code>svn&lt;/code>的自定义对比工具功能，可以实现双击版本打开对比工具。&lt;/p>
&lt;p>右键项目&lt;code>svn&lt;/code>根目录，选择设置（中文版同理）。&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;img src="https://boiltask.com/knowledge/ue/blueprint-diff/image-1-1.png"
width="529"
height="671"
srcset="https://boiltask.com/knowledge/ue/blueprint-diff/image-1-1_hu_94e9a3aad52ad4b4.png 480w, https://boiltask.com/knowledge/ue/blueprint-diff/image-1-1_hu_205d0019b349f504.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="78"
data-flex-basis="189px"
>&lt;/th>
&lt;th>&lt;img src="https://boiltask.com/knowledge/ue/blueprint-diff/image-1-2.png"
width="531"
height="670"
srcset="https://boiltask.com/knowledge/ue/blueprint-diff/image-1-2_hu_77eb9b52b359905.png 480w, https://boiltask.com/knowledge/ue/blueprint-diff/image-1-2_hu_4005d72fe17ccbea.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="79"
data-flex-basis="190px"
>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>英文版&lt;/td>
&lt;td>中文版&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>在对比工具页签下选择高级选项（中文版同理）。&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;img src="https://boiltask.com/knowledge/ue/blueprint-diff/image-2-1.png"
width="787"
height="548"
srcset="https://boiltask.com/knowledge/ue/blueprint-diff/image-2-1_hu_ac2685065378ed53.png 480w, https://boiltask.com/knowledge/ue/blueprint-diff/image-2-1_hu_18abed1718ceabb1.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="143"
data-flex-basis="344px"
>&lt;/th>
&lt;th>&lt;img src="https://boiltask.com/knowledge/ue/blueprint-diff/image-2-2.png"
width="773"
height="541"
srcset="https://boiltask.com/knowledge/ue/blueprint-diff/image-2-2_hu_b955a59da3c1b85c.png 480w, https://boiltask.com/knowledge/ue/blueprint-diff/image-2-2_hu_12e500b9c2478db.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="142"
data-flex-basis="342px"
>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>英文版&lt;/td>
&lt;td>中文版&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>在此窗口可以根据不同的文件后缀调用不同的对比工具，因此选择新增一条&lt;code>.uasset&lt;/code>文件设置。&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;img src="https://boiltask.com/knowledge/ue/blueprint-diff/image-3-1.png"
width="560"
height="439"
srcset="https://boiltask.com/knowledge/ue/blueprint-diff/image-3-1_hu_ed2b93d5a40326ac.png 480w, https://boiltask.com/knowledge/ue/blueprint-diff/image-3-1_hu_a04f208278062446.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="127"
data-flex-basis="306px"
>&lt;/th>
&lt;th>&lt;img src="https://boiltask.com/knowledge/ue/blueprint-diff/image-3-2.png"
width="560"
height="439"
srcset="https://boiltask.com/knowledge/ue/blueprint-diff/image-3-2_hu_8946e6802265fc31.png 480w, https://boiltask.com/knowledge/ue/blueprint-diff/image-3-2_hu_a88010d5aca36e74.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="127"
data-flex-basis="306px"
>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>英文版&lt;/td>
&lt;td>中文版&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>输入指定命令行即可。&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;img src="https://boiltask.com/knowledge/ue/blueprint-diff/image-4-1.png"
width="777"
height="180"
srcset="https://boiltask.com/knowledge/ue/blueprint-diff/image-4-1_hu_aeb811c03a6ec7a5.png 480w, https://boiltask.com/knowledge/ue/blueprint-diff/image-4-1_hu_a7659ed33b79e9b8.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="431"
data-flex-basis="1036px"
>&lt;/th>
&lt;th>&lt;img src="https://boiltask.com/knowledge/ue/blueprint-diff/image-4-2.png"
width="777"
height="180"
srcset="https://boiltask.com/knowledge/ue/blueprint-diff/image-4-2_hu_b316a11745c17a34.png 480w, https://boiltask.com/knowledge/ue/blueprint-diff/image-4-2_hu_171cf7fd8926ecca.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="431"
data-flex-basis="1036px"
>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>英文版&lt;/td>
&lt;td>中文版&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>扩展名输入：&lt;code>.uasset&lt;/code>&lt;/p>
&lt;p>命令行完整示例如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-Bash" data-lang="Bash">&lt;span class="line">&lt;span class="cl">D:&lt;span class="se">\M&lt;/span>etaEngine&lt;span class="se">\E&lt;/span>ngine&lt;span class="se">\B&lt;/span>inaries&lt;span class="se">\W&lt;/span>in64&lt;span class="se">\U&lt;/span>E4Editor.exe D:&lt;span class="se">\M&lt;/span>eta&lt;span class="se">\M&lt;/span>eta.uproject -diff %base %mine&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>其中&lt;code>D:\MetaEngine\Engine\Binaries\Win64\UE4Editor.exe&lt;/code>为引擎可执行文件，&lt;code>D:\Meta\Meta.uproject&lt;/code>为项目文件，&lt;code>%base&lt;/code>会被转义为&lt;code>svn&lt;/code>文件，&lt;code>%mine&lt;/code>会被转义为当前文件。&lt;/p>
&lt;h2 id="对比效果">&lt;a href="#%e5%af%b9%e6%af%94%e6%95%88%e6%9e%9c" class="header-anchor">&lt;/a>对比效果
&lt;/h2>&lt;p>&lt;img src="https://boiltask.com/knowledge/ue/blueprint-diff/image-5.png"
width="1010"
height="834"
srcset="https://boiltask.com/knowledge/ue/blueprint-diff/image-5_hu_9d78abcb2ba5b04e.png 480w, https://boiltask.com/knowledge/ue/blueprint-diff/image-5_hu_db2ab738b20b88e2.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="121"
data-flex-basis="290px"
>&lt;/p>
&lt;h2 id="注意事项">&lt;a href="#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9" class="header-anchor">&lt;/a>注意事项
&lt;/h2>&lt;p>由于引擎问题，部分格式的蓝图可能不被支持。&lt;/p>
&lt;p>打开对比工具的过程较为缓慢，请耐心等待。在此过程中不能关闭&lt;code>svn&lt;/code>版本历史窗口，以免目标临时文件被清除从而对比失败。&lt;/p>
&lt;p>此工具不能自动合并蓝图，因此仍需要自己手动合并文件，请谨慎操作避免冲突。&lt;/p>
&lt;p>期待&lt;code>UnrealEngine&lt;/code>能更为完善！&lt;/p></description></item></channel></rss>